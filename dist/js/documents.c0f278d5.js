(function(){var t={5343:function(t,e,s){"use strict";var i=s(538),r=s(6234),o=s(1251),n=s(813),a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"app"}},[t.id?e("document-detail",{attrs:{id:t.id}}):e("documents-list")],1)},c=[],l=s(655),u=s(140),d=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"documents-list"},[t.showFilterButton?e("button",{on:{click:function(e){t.showFilter=!0}}},[t._v("Show filter")]):t._e(),e("easy-refresh",{ref:"easyRefresh",staticClass:"documents-list__refresh",class:{"documents-list__refresh_error":t.isError},attrs:{"on-refresh":t.refresh,loadMore:t.loadMore,autoLoad:!0,userSelect:"false",showScrollBar:!0},scopedSlots:t._u([{key:"header",fn:function(){return[e("ClassicsHeader",{attrs:{finishDuration:0,refreshedText:"",refreshingText:t.$t("common.refreshingText"),refreshText:t.$t("common.pullToRefreshPrompt"),refreshReadyText:t.$t("common.releaseToRefreshPrompt")}})]},proxy:!0},{key:"footer",fn:function(){return[e("EmptyFooter")]},proxy:!0},{key:"scrollbar",fn:function(){return[e("ClassicsScrollBar",{attrs:{color:"rgba(0, 0, 0, 0.3)",bgColor:"transparent",width:"3",radius:"2"}})]},proxy:!0}])},[t.isError?e("background-icon-error",[e("p",[t._v("При загрузке списка документов произошла ошибка")])]):[t.showList?e("div",{staticClass:"documents-list__list",class:{"documents-list__list_bordered":t.showSkel}},t._l(t.items,(function(s){return e("document-card",{key:s.id,attrs:{source:s},nativeOn:{click:function(e){return t.openItem(s)}}})})),1):t._e(),e("documents-list-skel",{directives:[{name:"show",rawName:"v-show",value:t.showSkel,expression:"showSkel"}],staticClass:"documents-list__skel"})]],2),!t.showList||t.items.length||t.showSkel||t.isError?t._e():e("div",{staticClass:"documents-list__empty"},[t._v(" Список документов пуст ")]),e("keep-alive",[t.showFilter?e("documents-list-filter",{staticClass:"documents-list__filter",on:{apply:t.applyFilter,close:function(e){t.showFilter=!1}}}):t._e()],1)],1)},h=[],f=s(6318),p=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-card"},[e("user-profile",{attrs:{userProfile:t.userProfile}}),e("div",{staticClass:"document-card__title"},[e("p",[t._v(t._s(t.source.type))])]),t.showStatus?e("document-status",{staticClass:"document-card__status",attrs:{source:t.source}}):t._e(),t.source.rejected&&t.source.rejectionComment?e("document-comment-view",{staticClass:"document-card__comment",attrs:{rawText:t.source.rejectionComment}}):t._e(),e("div",{staticClass:"document-card__footer"},[e("p",[t._v(t._s(t.creationDate))]),t.showOpenButton?e("button",{on:{click:function(e){return e.stopPropagation(),t.openItem.apply(null,arguments)}}},[t._v(" Открыть "),e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"5",height:"9",fill:"none"}},[e("path",{attrs:{fill:"#fff","fill-rule":"evenodd",d:"M.793.5 5 4.5l-4.207 4L0 7.746 3.414 4.5 0 1.254.793.5Z","clip-rule":"evenodd"}})])]):t._e()])],1)},g=[],v=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"user-profile"},[e("div",{staticClass:"user-profile__icon"},[e("user-icon",{attrs:{userProfile:t.userProfile,size:30}})],1),e("div",{staticClass:"user-profile__text"},[e("p",{staticClass:"user-profile__name"},[t._v(t._s(t.userProfile.fullName))]),t._v(" "),e("p",{staticClass:"user-profile__position"},[t._v(t._s(t.userProfile.position))])])])},m=[],_=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"user__icon",style:t.cssStyle},[t.profilePhotoLink?e("img",{attrs:{src:t.profilePhotoLink}}):[t._v(" "+t._s(t.userProfile.initials)+" ")]],2)},w=[];let y=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"size",void 0),(0,f.Z)(this,"fontSize",void 0),(0,f.Z)(this,"iconSize",void 0),(0,f.Z)(this,"userProfile",void 0)}get sideSize(){return this.size+"px"}get localFontSize(){if(this.fontSize)return this.fontSize+"px";switch(this.size){case 24:return"8px";case 28:return"10px";case 32:return"11px";case 138:return"25px";default:return"14px"}}get cssStyle(){return{background:this.profileColor,width:this.sideSize,height:this.sideSize,flex:"0 0 "+this.sideSize,lineHeight:this.sideSize,fontSize:this.localFontSize}}get profileColor(){return this.userProfile?.profileColor}get profilePhotoLink(){const t=this.$store.state.session?.projectName,e=this.$store.state.session?.baseUrl,s=this.$store.state.session?.backendUrl||(e||"")+(t||"");if(!s)return"";const i=this.userProfile.photoFileId,r=(t,e=88)=>i?`${t}/images/${i}/download?width=${e}`:"";return this.iconSize<88?r(s):r(s,this.iconSize)}};(0,l.gn)([(0,u.fI)({default:44})],y.prototype,"size",void 0),(0,l.gn)([(0,u.fI)()],y.prototype,"fontSize",void 0),(0,l.gn)([(0,u.fI)({default:32})],y.prototype,"iconSize",void 0),(0,l.gn)([(0,u.fI)({required:!0})],y.prototype,"userProfile",void 0),y=(0,l.gn)([(0,u.wA)({components:{}})],y);var S=y,C=S,x=s(1001),Z=(0,x.Z)(C,_,w,!1,null,null,null),k=Z.exports,b=(0,i.defineComponent)({name:"",components:{UserIcon:k},props:{userProfile:{required:!0,type:Object}},data(){return{}}}),E=b,A=(0,x.Z)(E,v,m,!1,null,null,null),P=A.exports,I=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-status",style:{color:t.color}},[t.isSigned||t.isRejected?e("p",{staticClass:"document-status__main"},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"13",fill:"none"}},[t.isSigned?[e("path",{attrs:{fill:t.color,d:"M1.687 4.816c-.251 0-.455.187-.455.418 0 .23.204.417.455.417H6c.25 0 .454-.187.454-.417 0-.231-.203-.418-.454-.418H1.687ZM1.687 6.532c-.251 0-.455.187-.455.418 0 .23.204.418.455.418h3.805c.251 0 .455-.187.455-.418 0-.23-.204-.418-.455-.418H1.687ZM1.687 9.965c-.251 0-.455.187-.455.418 0 .23.204.417.455.417h6.288c.25 0 .454-.187.454-.418 0-.23-.203-.417-.454-.417H1.687ZM10.426 5.973a.316.316 0 0 0-.04-.472.386.386 0 0 0-.512.037l-.989 1.06-.356-.382a.386.386 0 0 0-.513-.036.316.316 0 0 0-.04.471l.564.604a.48.48 0 0 0 .69 0l1.196-1.282Z"}}),e("path",{attrs:{fill:t.color,"fill-rule":"evenodd",d:"M3.447.5a.952.952 0 0 0-.632.235L.277 2.994a.804.804 0 0 0-.277.6v8.07c0 .462.407.836.909.836h7.735c.502 0 .909-.374.909-.836V9.14a3.178 3.178 0 0 1-.451.033C10.703 9.168 12 7.973 12 6.5c0-1.476-1.3-2.672-2.906-2.672h.004c.155 0 .307.011.455.033V1.336C9.553.874 9.146.5 8.644.5H3.447Zm4 8.201c.351.223.758.376 1.197.439v2.524H.91V4.218H3.17c.502 0 .91-.374.91-.835V1.336h4.563V3.86c-1.39.2-2.455 1.305-2.455 2.64 0 .66.26 1.265.693 1.732H1.687c-.251 0-.455.187-.455.418 0 .23.204.417.455.417h5.31c.231 0 .423-.16.45-.366ZM3.171 3.383H1.147L3.17 1.58v1.802Zm5.923 4.953c1.103 0 1.997-.822 1.997-1.836 0-1.014-.894-1.836-1.997-1.836-1.102 0-1.997.822-1.997 1.836 0 1.014.895 1.836 1.997 1.836Z","clip-rule":"evenodd"}})]:[e("path",{attrs:{fill:t.color,d:"M1.687 4.316c-.251 0-.455.187-.455.418 0 .23.204.417.455.417H6c.25 0 .454-.187.454-.417 0-.231-.203-.418-.454-.418H1.687ZM1.687 6.032c-.251 0-.455.187-.455.418 0 .23.204.418.455.418h3.805c.251 0 .455-.187.455-.418 0-.23-.204-.418-.455-.418H1.687ZM1.687 9.465c-.251 0-.455.187-.455.418 0 .23.204.417.455.417h6.288c.25 0 .454-.187.454-.417 0-.231-.203-.418-.454-.418H1.687ZM9.698 5.01a.386.386 0 0 1 .514 0 .316.316 0 0 1 0 .472L9.648 6l.564.518a.316.316 0 0 1 0 .473.386.386 0 0 1-.514 0l-.564-.518-.563.518a.386.386 0 0 1-.514 0 .316.316 0 0 1 0-.473L8.62 6l-.563-.518a.316.316 0 0 1 0-.473.386.386 0 0 1 .514 0l.563.518.564-.518Z"}}),e("path",{attrs:{fill:t.color,"fill-rule":"evenodd",d:"M3.447 0a.952.952 0 0 0-.632.235L.277 2.494a.804.804 0 0 0-.277.6v8.07c0 .462.407.836.909.836h7.735c.502 0 .909-.374.909-.836V8.64a3.178 3.178 0 0 1-.451.033C10.703 8.668 12 7.473 12 6c0-1.476-1.3-2.672-2.906-2.672h-.006.01c.155 0 .307.011.455.033V.836C9.553.374 9.146 0 8.644 0H3.447Zm5.197 3.36V.836H4.08v2.047c0 .461-.407.835-.909.835H.91v7.446h7.735V8.64a3.038 3.038 0 0 1-1.197-.439c-.027.207-.219.366-.45.366h-5.31c-.251 0-.455-.187-.455-.417 0-.231.204-.418.455-.418h5.195A2.538 2.538 0 0 1 6.189 6c0-1.335 1.064-2.44 2.455-2.64Zm-5.473-.477H1.147L3.17 1.08v1.802ZM11.091 6c0 1.014-.894 1.836-1.997 1.836-1.102 0-1.997-.822-1.997-1.836 0-1.014.895-1.836 1.997-1.836 1.103 0 1.997.822 1.997 1.836Z","clip-rule":"evenodd"}})]],2),e("span",[t._v(t._s(t.text))])]):t._e(),t.showSigners&&t.extended?e("document-signers",{staticClass:"document-status__signers",attrs:{source:t.source}}):t._e()],1)},L=[];const R={locale:"ru",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},M=t=>t.toLocaleString(R).replace(",",""),j=t=>t.toLocaleString(R);var F=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-signers"},[t.waitingList.length?e("div",{staticClass:"document-signers__list"},[e("span",[t._v("Ожидает подписи:")]),t._l(t.waitingList,(function(s){return e("div",{staticClass:"document-signers__list-item"},[e("signer-profile",{attrs:{source:s},nativeOn:{click:function(e){return t.openProfile(s.profile)}}})],1)}))],2):t._e(),t.signedList.length?e("div",{staticClass:"document-signers__list"},[e("span",[t._v("Подписа"+t._s(t.signedList.length>1?"ли":"л"))]),t._l(t.signedList,(function(s){return e("div",{staticClass:"document-signers__list-item"},[e("signer-profile",{attrs:{source:s},nativeOn:{click:function(e){return t.openProfile(s.profile)}}})],1)}))],2):t._e()])},D=[],H=(s(7658),function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"signer-profile"},[t.source.profile?e("user-icon",{staticClass:"signer-profile__icon",attrs:{userProfile:t.source.profile,size:25}}):t._e(),e("span",[t._v(t._s(t.source.name))])],1)}),T=[];let O=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"source",void 0)}};(0,l.gn)([(0,u.fI)()],O.prototype,"source",void 0),O=(0,l.gn)([(0,u.wA)({components:{UserIcon:k}})],O);var $=O,B=$,V=(0,x.Z)(B,H,T,!1,null,null,null),N=V.exports;let z=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"source",void 0)}openProfile(t){const e=this.getLink(t?.id);e&&(document.location.href=e)}getLink(t){if(t){let e={schemaId:"UserProfiles",objectId:t};return"actor:ContactsPageActor?params="+encodeURIComponent(JSON.stringify(e))}return""}get waitingList(){const t=[];return this.waitingForCurrentUser&&t.push({name:"Вы"}),this.waitingForHead&&this.headProfile&&!this.currentUserIsHeadManager&&t.push({name:this.headProfile.fullName||"",profile:this.headProfile}),this.waitingForEmployees&&t.push(...this.waitingForEmployees.map((t=>({name:t.fullName||"",profile:t})))),t.length>1&&t.forEach(((e,s)=>{s<t.length-1&&(e.name+=",")})),t}get signedList(){const t=[];this.headProfile?.signedAt&&t.push({name:this.headProfile.fullName||"",profile:this.headProfile});const e=this.employeesSigned.map((t=>({name:t.fullName||"",profile:t})));return t.push(...e),t}get currentUserIsHeadManager(){return this.currentUserProfile.id===this.headProfile?.id}get waitingForCurrentUser(){return!this.source.signed}get waitingForHead(){const t=!!this.headProfile?.rejectedAt,e=!!this.headProfile?.signedAt;return!t&&!e}get waitingForEmployees(){return this.employees.filter((t=>!t.signedAt&&!t.rejectedAt))}get employeesSigned(){return this.employees.filter((t=>!!t.signedAt))}get employees(){return this.source.employees}get headProfile(){return this.source.headManager}get currentUserProfile(){return this.$store.state.userProfile}};(0,l.gn)([(0,u.fI)({required:!0})],z.prototype,"source",void 0),z=(0,l.gn)([(0,u.wA)({components:{SignerProfile:N}})],z);var U=z,q=U,K=(0,x.Z)(q,F,D,!1,null,null,null),W=K.exports;let G=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"source",void 0),(0,f.Z)(this,"extended",void 0)}get text(){const t=this.isSigned?"Подписано":"Отклонено",e=this.isSigned?this.source.signedAt:this.source.rejectedAt;let s=e?j(e):"";return s&&(s=" "+s),`${t} вами${s}`}get color(){return this.isRejected?"#FF5249":"#19B817"}get isSigned(){return this.source.signed}get isRejected(){return this.source.rejected}get showSigners(){return!this.source.rejected}};(0,l.gn)([(0,u.fI)()],G.prototype,"source",void 0),(0,l.gn)([(0,u.fI)({default:!1})],G.prototype,"extended",void 0),G=(0,l.gn)([(0,u.wA)({components:{DocumentSigners:W}})],G);var J=G,Q=J,Y=(0,x.Z)(Q,I,L,!1,null,null,null),X=Y.exports,tt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-comment-view",class:{"document-comment-view_may-be-exapanded":t.mayBeExpanded,"document-comment-view_cut":!t.expanded}},[e("p",{on:{click:t.toggle}},[t._v("Комментарий: "+t._s(t.text))])])},et=[],st=s(1036);function it(t){return(t||"").replace(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi,(function(t,e,s){let i=s;return i.match("^https?://")||(i="http://"+i),e+'<a href="'+i+'" target="_blank">'+s+"</a>"}))}function rt(t){return t.split("\n").join("<br/>")}function ot(t){const e=/&lt;\/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))&gt;/gi,s=t.replace(e,"");return s}const nt=(t,e=[],s=!1)=>(e=e.length?e:st.defaults.allowedTags.concat(["img"]),st(t,{allowedTags:e,disallowedTagsMode:s?"escape":"discard",allowedAttributes:{a:["href","name","target","class"],img:["src","width","height","style","class"],iframe:["src","width","height","style","class","frameborder","scrolling","allowfullscreen","allow"],div:["class"]},allowedSchemes:["http","https","ftp","mailto","forms"]})),at=(t,e=[],s=!1)=>{let i=t||"";return i=nt(t||"",e,s),i=it(i),i=rt(i),i=ot(i),i};let ct=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"rawText",void 0),(0,f.Z)(this,"mayBeExpanded",void 0),(0,f.Z)(this,"expanded",!1)}toggle(){this.mayBeExpanded&&(this.expanded=!this.expanded)}get text(){return at(this.rawText)}};(0,l.gn)([(0,u.fI)()],ct.prototype,"rawText",void 0),(0,l.gn)([(0,u.fI)({default:!1})],ct.prototype,"mayBeExpanded",void 0),ct=(0,l.gn)([(0,u.wA)({components:{}})],ct);var lt=ct,ut=lt,dt=(0,x.Z)(ut,tt,et,!1,null,null,null),ht=dt.exports,ft=s(5423);let pt=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"source",void 0)}openItem(){const t=this.source,e=(0,ft.Rg)(this.$store.getters["platform"],{id:t.id},t.type);document.location.href=e}get userProfile(){return this.source.creator}get showStatus(){return this.source.rejected||this.source.signed}get creationDate(){return M(this.source.createdAt)}get showOpenButton(){const{rejected:t,signed:e}=this.source;return!t&&!e}};(0,l.gn)([(0,u.fI)()],pt.prototype,"source",void 0),pt=(0,l.gn)([(0,u.wA)({components:{UserProfile:P,DocumentStatus:X,DocumentCommentView:ht}})],pt);var gt=pt,vt=gt,mt=(0,x.Z)(vt,p,g,!1,null,null,null),_t=mt.exports,wt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"documents-list-filter"},[e("div",{staticClass:"documents-list-filter__container"},[e("header",{staticClass:"documents-list-filter__header"},[e("div",{staticClass:"documents-list-filter__reset"},[e("button",{on:{click:t.reset}},[t._v("Сбросить")])]),t._m(0),e("div",{staticClass:"documents-list-filter__close"},[e("button",{on:{click:function(e){return t.$emit("close")}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none"}},[e("path",{attrs:{fill:"#373737",d:"M7.05 5.636 18.364 16.95l-1.414 1.414L5.636 7.05z"}}),e("path",{attrs:{fill:"#373737",d:"m16.95 5.636 1.414 1.414L7.05 18.364 5.636 16.95z"}})])])])]),e("main",[e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v(" Период публикации ")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__date"},[e("date-input",{model:{value:t.dateLeft,callback:function(e){t.dateLeft=e},expression:"dateLeft"}}),t._v(" — "),e("date-input",{model:{value:t.dateRight,callback:function(e){t.dateRight=e},expression:"dateRight"}})],1)]),e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v("Статус документа")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__status"},t._l(t.statuses,(function(s){return e("status-tag",{key:s.id,attrs:{active:s.isActive},on:{toggle:function(t){s.isActive=!s.isActive}},scopedSlots:t._u([{key:"icon",fn:function(){return[e(s.iconName,{tag:"component",attrs:{inverted:s.isActive}})]},proxy:!0}],null,!0)},[t._v(" "+t._s(s.title)+" ")])})),1)]),e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v("Статус документа для пользователя")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__status"},t._l(t.employeeSignerStatuses,(function(s){return e("status-tag",{key:s.id,attrs:{active:s.isActive},on:{toggle:function(t){s.isActive=!s.isActive}},scopedSlots:t._u([{key:"icon",fn:function(){return[e(s.iconName,{tag:"component",attrs:{inverted:s.isActive}})]},proxy:!0}],null,!0)},[t._v(" "+t._s(s.title)+" ")])})),1)]),e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v("Статус документа для руководителя")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__status"},t._l(t.headSignerStatuses,(function(s){return e("status-tag",{key:s.id,attrs:{active:s.isActive},on:{toggle:function(t){s.isActive=!s.isActive}},scopedSlots:t._u([{key:"icon",fn:function(){return[e(s.iconName,{tag:"component",attrs:{inverted:s.isActive}})]},proxy:!0}],null,!0)},[t._v(" "+t._s(s.title)+" ")])})),1)])],1)]),e("footer",[e("button-1",{on:{click:t.apply}},[t._v("Применить")])],1)])},yt=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"documents-list-filter__title"},[e("span",[t._v("Фильтр")])])}],St=s(6226),Ct=s(3437),xt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("section",{staticClass:"documents-list-filter-section"},[e("header",[e("p",[t._t("header")],2)]),e("div",{staticClass:"documents-list-filter-section__content"},[t._t("default")],2)])},Zt=[];let kt=class extends u.w3{};kt=(0,l.gn)([(0,u.wA)({components:{}})],kt);var bt=kt,Et=bt,At=(0,x.Z)(Et,xt,Zt,!1,null,null,null),Pt=At.exports,It=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"status-tag",class:{"status-tag_active":t.active},on:{click:function(e){return t.$emit("toggle")}}},[e("div",{staticClass:"status-tag__icon"},[t._t("icon")],2),e("span",[t._t("default")],2)])},Lt=[];let Rt=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"active",void 0)}};(0,l.gn)([(0,u.fI)({default:!1})],Rt.prototype,"active",void 0),Rt=(0,l.gn)([(0,u.wA)({components:{}})],Rt);var Mt,jt=Rt,Ft=jt,Dt=(0,x.Z)(Ft,It,Lt,!1,null,null,null),Ht=Dt.exports;(function(t){t["draft"]="DRAFT",t["inProcess"]="IN_PROCESS",t["completed"]="COMPLETED",t["rejected"]="REJECTED",t["deleted"]="DELETED",t["notSeen"]="NOT_SEEN",t["seen"]="SEEN",t["signed"]="SIGNED"})(Mt||(Mt={}));const Tt=()=>[{id:Mt.completed,title:"Завершен",isActive:!1,iconName:"document-check-icon"},{id:Mt.rejected,title:"Отменен",isActive:!1,iconName:"cross-icon"},{id:Mt.inProcess,title:"В процессе",isActive:!1,iconName:"document-progress-icon"}],Ot=()=>[{id:Mt.notSeen,title:"Не просмотрен",isActive:!1,iconName:"eye-strikethrough-icon"},{id:Mt.seen,title:"Просмотрен",isActive:!1,iconName:"eye-icon"},{id:Mt.rejected,title:"Отклонен",isActive:!1,iconName:"cross-icon"},{id:Mt.signed,title:"Подписан",isActive:!1,iconName:"apply-icon"}];var $t=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{staticClass:"outlined-eye-svg",attrs:{width:"15",height:"15",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[e("path",{attrs:{fill:t.color,d:"M19.337 9.787A10.431 10.431 0 0 0 10 3.125 10.431 10.431 0 0 0 .662 9.787a.625.625 0 0 0 0 .425A10.431 10.431 0 0 0 10 16.876a10.431 10.431 0 0 0 9.337-6.662.625.625 0 0 0 0-.425ZM10 15.625c-3.313 0-6.813-2.456-8.081-5.625C3.187 6.831 6.687 4.375 10 4.375c3.313 0 6.813 2.456 8.081 5.625-1.268 3.169-4.768 5.625-8.081 5.625Zm0-9.375a3.75 3.75 0 1 0 0 7.5 3.75 3.75 0 0 0 0-7.5Zm0 6.25a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z"}})])},Bt=[];let Vt=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#373737"}};(0,l.gn)([(0,u.fI)()],Vt.prototype,"inverted",void 0),Vt=(0,l.gn)([u.wA],Vt);var Nt=Vt,zt=Nt,Ut=(0,x.Z)(zt,$t,Bt,!1,null,null,null),qt=Ut.exports,Kt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{staticClass:"outlined-stroked-eye-svg",attrs:{width:"15",height:"15",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[e("path",{attrs:{fill:t.color,d:"m3.275 14.069.894-.888A8.788 8.788 0 0 1 1.919 10C3.187 6.831 6.687 4.375 10 4.375a7.738 7.738 0 0 1 2.5.45l.969-.975A9.2 9.2 0 0 0 10 3.125 10.431 10.431 0 0 0 .662 9.787a.625.625 0 0 0 0 .425 10 10 0 0 0 2.613 3.857ZM7.5 9.83A2.5 2.5 0 0 1 9.813 7.52l1.13-1.138a3.75 3.75 0 0 0-4.58 4.582L7.5 9.83Zm11.837-.043a10.25 10.25 0 0 0-3.587-4.65l3-3.007-.881-.881L1.25 17.869l.881.881 3.188-3.188A9.556 9.556 0 0 0 10 16.875a10.431 10.431 0 0 0 9.337-6.662.625.625 0 0 0 0-.425ZM12.5 10a2.5 2.5 0 0 1-3.75 2.15l3.4-3.4A2.5 2.5 0 0 1 12.5 10ZM10 15.625a8.156 8.156 0 0 1-3.75-.988l1.588-1.587a3.75 3.75 0 0 0 5.218-5.219l1.794-1.794A9.087 9.087 0 0 1 18.081 10c-1.268 3.169-4.768 5.625-8.081 5.625Z"}})])},Wt=[];let Gt=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#f3f3f3":"#b9bfc7"}};(0,l.gn)([(0,u.fI)()],Gt.prototype,"inverted",void 0),Gt=(0,l.gn)([u.wA],Gt);var Jt=Gt,Qt=Jt,Yt=(0,x.Z)(Qt,Kt,Wt,!1,null,null,null),Xt=Yt.exports,te=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{staticClass:"outlined-fail-circle-svg",attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[e("path",{attrs:{fill:t.color,d:"M13.381 14.375 10 10.995l-3.381 3.38-.994-.994L9.005 10l-3.38-3.38.994-.995L10 9.005l3.38-3.38.995.994L10.995 10l3.38 3.381-.994.994ZM10 2.5A7.5 7.5 0 1 1 2.5 10 7.509 7.509 0 0 1 10 2.5Zm0-1.25a8.75 8.75 0 1 0 0 17.5 8.75 8.75 0 0 0 0-17.5Z"}})])},ee=[];let se=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#FF5249"}};(0,l.gn)([(0,u.fI)()],se.prototype,"inverted",void 0),se=(0,l.gn)([u.wA],se);var ie=se,re=ie,oe=(0,x.Z)(re,te,ee,!1,null,null,null),ne=oe.exports,ae=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{staticClass:"outlined-success-circle-svg",attrs:{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[e("path",{attrs:{fill:t.color,d:"M10 1.25a8.75 8.75 0 1 0 0 17.5 8.75 8.75 0 0 0 0-17.5Zm0 16.25a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Zm-1.25-4.063-3.125-3.1.994-.98 2.131 2.112 4.631-4.594.994.987-5.625 5.575Z"}})])},ce=[];let le=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#24a148"}};(0,l.gn)([(0,u.fI)()],le.prototype,"inverted",void 0),le=(0,l.gn)([u.wA],le);var ue=le,de=ue,he=(0,x.Z)(de,ae,ce,!1,null,null,null),fe=he.exports,pe=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"13",fill:"none"}},[e("path",{attrs:{fill:t.color,d:"M10.118 5.571V3.714a.43.43 0 0 0-.037-.178.463.463 0 0 0-.109-.152L6.431.134A.546.546 0 0 0 6.07 0h-5.06C.454 0 0 .416 0 .929V12.07c0 .513.453.929 1.012.929h8.095c.558 0 1.011-.416 1.011-.929v-.928H9.107v.928H1.012V.93h4.047v2.785c0 .513.454.929 1.012.929h3.036v.928h1.011ZM6.071 3.714V1.12L8.9 3.714H6.071Z"}}),e("path",{attrs:{fill:t.color,"fill-rule":"evenodd",d:"m11.267 6.656-4.06 4.07a.549.549 0 0 1-.395.157.547.547 0 0 1-.39-.166L4.114 8.29l.794-.635 1.92 2.02 3.662-3.671.777.652Z","clip-rule":"evenodd"}})])},ge=[];let ve=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#373737"}};(0,l.gn)([(0,u.fI)()],ve.prototype,"inverted",void 0),ve=(0,l.gn)([u.wA],ve);var me=ve,_e=me,we=(0,x.Z)(_e,pe,ge,!1,null,null,null),ye=we.exports,Se=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"11",height:"13",fill:"none"}},[e("path",{attrs:{fill:t.color,d:"M11 7.893H4.964L6.146 6.69 5.5 6.036 3.208 8.357 5.5 10.68l.646-.655-1.182-1.203H11v-.928ZM9.167 5.57V3.714a.47.47 0 0 0-.133-.33L5.826.134A.458.458 0 0 0 5.5 0H.917A.923.923 0 0 0 0 .929V12.07c0 .513.41.929.917.929H8.25a.923.923 0 0 0 .917-.929v-.928H8.25v.928H.917V.93h3.666v2.785c0 .513.411.929.917.929h2.75v.928h.917ZM5.5 3.714V1.12l2.562 2.595H5.5Z"}})])},Ce=[];let xe=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#373737"}};(0,l.gn)([(0,u.fI)()],xe.prototype,"inverted",void 0),xe=(0,l.gn)([u.wA],xe);var Ze=xe,ke=Ze,be=(0,x.Z)(ke,Se,Ce,!1,null,null,null),Ee=be.exports;let Ae=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"dateLeft",""),(0,f.Z)(this,"dateRight",""),(0,f.Z)(this,"statuses",Tt()),(0,f.Z)(this,"employeeSignerStatuses",Ot()),(0,f.Z)(this,"headSignerStatuses",Ot())}apply(){this.$emit("apply",this.filterState),this.$emit("close")}reset(){this.dateLeft="",this.dateRight="",this.statuses=Tt(),this.employeeSignerStatuses=Ot(),this.headSignerStatuses=Ot(),this.apply()}get filterState(){return{documentDateFrom:this.dateLeft,documentDateTo:this.dateRight,statuses:this.statuses.filter((t=>t.isActive)).map((t=>t.id)),employeeSignerStatuses:this.employeeSignerStatuses.filter((t=>t.isActive)).map((t=>t.id)),headSignerStatuses:this.headSignerStatuses.filter((t=>t.isActive)).map((t=>t.id))}}};Ae=(0,l.gn)([(0,u.wA)({components:{DateInput:St.Z,Button1:Ct.Z,DocumentListFilterSection:Pt,DocumentsListFilterSection:Pt,StatusTag:Ht,EyeIcon:qt,EyeStrikethroughIcon:Xt,CrossIcon:ne,ApplyIcon:fe,DocumentCheckIcon:ye,DocumentProgressIcon:Ee}})],Ae);var Pe=Ae,Ie=Pe,Le=(0,x.Z)(Ie,wt,yt,!1,null,null,null),Re=Le.exports,Me=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"skel"},[e("div",{staticClass:"skel__first-row"},t._l([1,2,3,4,5],(function(s){return e("div",{key:s,staticClass:"skel__item"},[t._m(0,!0),t._m(1,!0)])})),0)])},je=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"skel__profile"},[e("div",{staticClass:"skel__circle &__bg",staticStyle:{width:"38px",height:"38px","border-radius":"38px"}}),e("div",{staticClass:"skel__profile-text"},[e("div",{staticClass:"skel__rect &__bg",staticStyle:{width:"120px",height:"8px"}}),e("div",{staticClass:"skel__rect &__bg",staticStyle:{width:"100px",height:"7px"}})])])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"skel__title"},[e("div",{staticClass:"skel__rect",staticStyle:{width:"278px","max-width":"100%",height:"10px"}}),e("div",{staticClass:"skel__rect",staticStyle:{width:"192px","max-width":"74%",height:"10px"}}),e("div",{staticClass:"skel__rect",staticStyle:{width:"225px","max-width":"84%",height:"10px"}})])}];let Fe=class extends u.w3{};Fe=(0,l.gn)([(0,u.wA)({components:{}})],Fe);var De=Fe,He=De,Te=(0,x.Z)(He,Me,je,!1,null,null,null),Oe=Te.exports,$e=s(9669),Be=s.n($e);class Ve{constructor(t,e){(0,f.Z)(this,"queryFabric",void 0),(0,f.Z)(this,"hrLinkRepository",void 0),(0,f.Z)(this,"cancelToken",void 0),this.queryFabric=t,this.hrLinkRepository=e}async load(t){const e=this.queryFabric.getQuery(t);return this.cancelToken&&this.cancelToken.cancel(),this.cancelToken=Be().CancelToken.source(),await this.hrLinkRepository.getDocuments(e,{cancelToken:this.cancelToken.token})}}class Ne{constructor(t){(0,f.Z)(this,"pagingState",void 0),this.pagingState=t}getQuery(t){let e=t;const s={take:this.pagingState.take,skip:this.pagingState.skip,where:e};return s}}var ze,Ue=s(1671);(function(t){t["new"]="new",t["filter"]="filter",t["send"]="send",t["save"]="save",t["edit"]="edit"})(ze||(ze={}));var qe=ze,Ke=s(3109);let We=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"documentsListService",void 0),(0,f.Z)(this,"items",[]),(0,f.Z)(this,"pagingState",{skip:0,take:20}),(0,f.Z)(this,"isLoading",!1),(0,f.Z)(this,"isOnRefresh",!1),(0,f.Z)(this,"loaded",!1),(0,f.Z)(this,"isError",!1),(0,f.Z)(this,"showFilter",!1),(0,f.Z)(this,"filterState",{documentDateFrom:"",documentDateTo:"",statuses:[],employeeSignerStatuses:[],headSignerStatuses:[]})}created(){this.documentsListService=new Ve(new Ne(this.pagingState),this.$hrLinkRepository)}mounted(){window.clickButton=this.buttonClicked,this.getList()}async getList(t=!1){this.isLoading=!0,this.resetEasyRefreshScroll(),this.pagingState.skip=t?this.items?.length??0:0;try{const e=await this.documentsListService.load(this.filterState);if(this.isError=!1,t&&this.items?this.items=[...this.items,...e]:this.items=e,e.length<this.pagingState.take)return!0}catch(e){this.isError=!0,this.$store.dispatch("reportError",e)}finally{this.isLoading=!1,this.loaded=!0}return!1}resetEasyRefreshScroll(){this.$nextTick((()=>{const t=this.$refs.easyRefresh;t&&t.onResize()}))}async loadMore(t){if(this.isError)return void t(!0);const e=await this.getList(!0);t(e)}async refresh(t){try{this.isOnRefresh=!0,await this.getList(),t()}catch(e){this.$store.dispatch("reportError",e)}finally{this.isOnRefresh=!1}}buttonClicked(t){t===qe.filter&&(this.showFilter=!0)}openItem(t){const e=(0,ft.Rg)(this.$store.getters["platform"],{id:t.id},t.type);document.location.href=e}applyFilter(t){this.filterState=t,(0,Ke.WS)([{type:qe.filter,params:{filtered:this.filterHasValue}}]),this.items=[],this.getList()}get filterHasValue(){const{documentDateFrom:t,documentDateTo:e,statuses:s,employeeSignerStatuses:i,headSignerStatuses:r}=this.filterState;return!!t||!!e||!!s?.length||!!i?.length||!!r?.length}get showList(){return this.loaded}get showSkel(){return this.isLoading&&!this.isOnRefresh}get listIsEmpty(){return!1}get showFilterButton(){return"Web"===this.$store.getters["platform"]}};We=(0,l.gn)([(0,u.wA)({components:{DocumentCard:_t,DocumentsListFilter:Re,DocumentsListSkel:Oe,BackgroundIconError:Ue.Z}})],We);var Ge=We,Je=Ge,Qe=(0,x.Z)(Je,d,h,!1,null,null,null),Ye=Qe.exports,Xe=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-detail"},[!t.isError&&t.item?[t.isSign||t.isReject?[t.isSign?e("document-sign",{attrs:{source:t.item},on:{signed:t.load}}):t._e(),t.isReject?e("document-reject",{attrs:{source:t.item}}):t._e()]:e("document-view",{attrs:{source:t.item}})]:t.isError?e("background-icon-error",[e("p",[t._v("При загрузке документа произошла ошибка")])]):t._e()],2)},ts=[],es=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-sign"},[t.isError||t.currentState.matches(t.State.signIsSucceed)?t._e():[e("div",{staticClass:"document-sign__container"},[e("div",{staticClass:"document-sign__title"},[e("p",[t._v('Вы подписываете документ "'+t._s(t.source.type)+'"')])]),e("document-info",{attrs:{source:t.source}}),e("pin-code",{attrs:{error:t.isPinCodeError},model:{value:t.pinCodeValue,callback:function(e){t.pinCodeValue=e},expression:"pinCodeValue"}}),e("div",{staticClass:"document-sign__troubleshooting",class:{"document-sign__troubleshooting_can-restart":t.canRestartSign,"document-sign__troubleshooting_error":t.currentState.matches(t.State.wrongCode)}},[e("p",[e("span",[t._v(t._s(t.currentState.matches(t.State.wrongCode)?"Неверный код!":"Не пришел код?")+" ")]),t.canRestartSign?e("a",{on:{click:t.restart}},[t._v("Отправить повторно")]):e("a",[t._v("Отправить повторно через "+t._s(t.time))])])])],1),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.confirm}},[t._v("Подтвердить")])],1)],t.isBusy?e("div",{staticClass:"document-sign__loading"},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"41",height:"41",fill:"none"}},[e("circle",{attrs:{cx:"20.5",cy:"20.5",r:"18.5",stroke:"#373737","stroke-width":"3"}}),e("mask",{attrs:{id:"a",fill:"#fff"}},[e("path",{attrs:{d:"M40.5 20.5A20 20 0 0 0 13.795 1.657l1.009 2.835A16.99 16.99 0 0 1 37.49 20.5H40.5Z"}})]),e("path",{attrs:{stroke:"#FFB400","stroke-width":"6",d:"M40.5 20.5A20 20 0 0 0 13.795 1.657l1.009 2.835A16.99 16.99 0 0 1 37.49 20.5H40.5Z",mask:"url(#a)"}})]),t.currentState.matches(t.State.onConfirmation)?e("div",[t._v("Подписываем документ")]):t._e()]):t._e(),t.currentState.matches(t.State.startSignError)?[e("background-icon-error",[e("p",[t._v(t._s(t.errorMessage))])]),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.startSign}},[t._v("Повторить попытку")])],1)]:t._e(),t.currentState.matches(t.State.confirmationError)?[e("background-icon-error",[e("p",[t._v("Ошибка! "),e("br"),t._v(" Не удалось подписать документ")])]),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.confirm}},[t._v("Повторить попытку")])],1)]:t._e(),t.currentState.matches(t.State.signIsSucceed)?[e("background-icon-success",[e("p",[t._v("Вы подписали документ!")])]),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.goToList}},[t._v("К списку документов")])],1)]:t._e()],2)},ss=[],is=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"sms-sign",class:{"sms-sign_error":t.error}},[e("p",{staticClass:"sms-sign__title"},[t._v("Введите код из SMS или E-mail")]),e("div",{staticClass:"sms-sign__input"},[e("p",[t._v("Мы отправили код подтверждения на номер:")]),e("div",{staticClass:"sms-sign__code"},t._l(t.value,(function(s,i){return e("input",{key:i,ref:"inputs",refInFor:!0,attrs:{autofocus:0===i,type:"number",inputmode:"numeric"},domProps:{value:s},on:{input:function(e){return t.inputHandler(e,i)},keydown:function(e){return t.filterKeyDown(e,i)}}})})),0)])])},rs=[];let os=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"value",void 0),(0,f.Z)(this,"error",void 0)}inputHandler(t,e){let s=t.target?.value;this.input(s,e)}input(t,e){const s=this.getInputRefs();if(t&&t.length>1)return void this.paste(t,e);"object"===typeof s&&t&&s[e+1]?.focus();const i=this.value.map(((s,i)=>i===e?t:s));this.$emit("input",i)}getInputRefs(){return this.$refs?.inputs}filterKeyDown(t,e){const s=this.$refs;if(void 0!==t.key){const i=t.ctrlKey||t.metaKey,r="v"===t.key&&i,o="a"===t.key&&i;if(r||o)return;const n=t.target?.value,a=t.key,c="Backspace"===a||"Delete"===a||"Meta"===a||"Control"===a,l=(n?.length??0)>0,u="e"===a;"Backspace"===a&&(this.value[e]||s.inputs[e-1]?.focus()),!l&&!u||c||(u||(s.inputs[e+1]?.focus(),this.input(a,e)),t.preventDefault())}else if(void 0!==t.which||void 0!=t.keyCode)throw Error("event.key is not supported")}paste(t,e){const s=t.split(""),i=this.value.length-e,r=s.slice(0,i),o=r.length+e-1,n=this.value.map(((t,s)=>s>=e?r[s-e]:t));this.getInputRefs()?.[o].focus(),this.$emit("input",n)}};(0,l.gn)([(0,u.fI)()],os.prototype,"value",void 0),(0,l.gn)([(0,u.fI)({default:!1})],os.prototype,"error",void 0),os=(0,l.gn)([(0,u.wA)({components:{}})],os);var ns=os,as=ns,cs=(0,x.Z)(as,is,rs,!1,null,null,null),ls=cs.exports,us=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-info"},[t.source.creator?e("user-profile",{attrs:{userProfile:t.source.creator}}):t._e(),e("div",{staticClass:"document-info__text"},[e("p",[e("span",[t._v("Сформировано:")]),t._v(" "+t._s(t.creationDate)+" ")]),e("document-status",{staticClass:"document-info__status",attrs:{source:t.source,extended:!0}})],1)],1)},ds=[];let hs=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"source",void 0)}get creationDate(){return M(this.source.createdAt)}};(0,l.gn)([(0,u.fI)({required:!0})],hs.prototype,"source",void 0),hs=(0,l.gn)([(0,u.wA)({components:{UserProfile:P,DocumentStatus:X}})],hs);var fs=hs,ps=fs,gs=(0,x.Z)(ps,us,ds,!1,null,null,null),vs=gs.exports,ms=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("background-icon-root",{scopedSlots:t._u([{key:"text",fn:function(){return[t._t("default")]},proxy:!0}],null,!0)},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"170",height:"178",fill:"none"}},[e("path",{attrs:{fill:"#EAECF0",d:"M85 170c46.944 0 85-38.056 85-85S131.944 0 85 0 0 38.056 0 85s38.056 85 85 85Z"}}),e("path",{attrs:{fill:"#fff",d:"M33.5 178h102V61.257c-4.808-.006-9.417-2.037-12.816-5.647-3.4-3.61-5.312-8.505-5.317-13.61H51.633a20.16 20.16 0 0 1-1.374 7.37 19.242 19.242 0 0 1-3.942 6.24 17.985 17.985 0 0 1-5.876 4.187c-2.2.969-4.56 1.465-6.941 1.46V178Z"}}),e("path",{attrs:{fill:"#19B817",d:"M85 115.6c15.022 0 27.2-12.178 27.2-27.2 0-15.022-12.178-27.2-27.2-27.2-15.022 0-27.2 12.178-27.2 27.2 0 15.022 12.178 27.2 27.2 27.2Z"}}),e("path",{attrs:{fill:"#EAECF0",d:"M99.733 122.4H70.267a3.4 3.4 0 1 0 0 6.8h29.466a3.4 3.4 0 0 0 0-6.8ZM109.933 136H60.066a3.4 3.4 0 1 0 0 6.8h49.867a3.4 3.4 0 1 0 0-6.8Z"}}),e("path",{attrs:{fill:"#fff","fill-rule":"evenodd",d:"M101 80.663 80.756 102 69 89.609l2.62-2.663 9.136 9.629L98.38 78l2.62 2.663Z","clip-rule":"evenodd"}})])])},_s=[],ws=s(7343);let ys=class extends u.w3{};ys=(0,l.gn)([(0,u.wA)({components:{BackgroundIconRoot:ws.Z}})],ys);var Ss=ys,Cs=Ss,xs=(0,x.Z)(Cs,ms,_s,!1,null,null,null),Zs=xs.exports,ks=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("background-icon-root",{scopedSlots:t._u([{key:"text",fn:function(){return[t._t("default")]},proxy:!0}],null,!0)},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"171",height:"178",fill:"none"}},[e("path",{attrs:{fill:"#EAECF0",d:"M85.5 170c46.944 0 85-38.056 85-85s-38.056-85-85-85S.5 38.056.5 85s38.056 85 85 85Z"}}),e("path",{attrs:{fill:"#fff",d:"M34 178h102V61.257c-4.808-.006-9.417-2.037-12.816-5.647-3.4-3.61-5.312-8.505-5.317-13.61H52.133a20.16 20.16 0 0 1-1.374 7.37 19.242 19.242 0 0 1-3.942 6.24 17.985 17.985 0 0 1-5.876 4.187c-2.2.969-4.56 1.465-6.941 1.46V178Z"}}),e("path",{attrs:{fill:"#EAECF0",d:"M100.233 122.4H70.767a3.4 3.4 0 1 0 0 6.8h29.466a3.4 3.4 0 1 0 0-6.8ZM110.433 136H60.566a3.4 3.4 0 1 0 0 6.8h49.867a3.4 3.4 0 1 0 0-6.8Z"}}),e("path",{attrs:{fill:"#98A2B3",d:"M84.366 115.2c15.022 0 27.2-12.178 27.2-27.2 0-15.022-12.178-27.2-27.2-27.2-15.022 0-27.2 12.178-27.2 27.2 0 15.022 12.178 27.2 27.2 27.2Z"}}),e("path",{attrs:{fill:"#fff","fill-rule":"evenodd",d:"M99.362 82.073a9.5 9.5 0 0 1-9.5 9.5 9.459 9.459 0 0 1-4.509-1.136L79.27 96.62l2.93 2.734-3.788 4.073-3.001-3.019-2.198 2.233-3.841-3.806L81.524 86.63a9.457 9.457 0 0 1-1.162-4.557 9.5 9.5 0 0 1 19 0Zm-5 0a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0Z","clip-rule":"evenodd"}})])])},bs=[];let Es=class extends u.w3{};Es=(0,l.gn)([(0,u.wA)({components:{BackgroundIconRoot:ws.Z}})],Es);var As,Ps,Is=Es,Ls=Is,Rs=(0,x.Z)(Ls,ks,bs,!1,null,null,null),Ms=Rs.exports,js=s(9490),Fs=s(1892),Ds=s(5399);(function(t){t["success"]="SUCCESS",t["startSignError"]="START_SIGN_ERROR",t["confirmationError"]="CONFORMATION_ERROR",t["wrongCodeError"]="WRONG_CODE_ERROR",t["invalidCode"]="INVALID_CODE",t["resetCodeValidation"]="RESET_CODE_VALIDATION",t["startSign"]="START_SIGN",t["confirm"]="CONFIRM",t["retryStart"]="RETRY_START",t["retryConfirm"]="RETRY_CONFIRM"})(As||(As={})),function(t){t["initial"]="initial",t["onSignStart"]="onSignStart",t["waitingCodeInput"]="waitingCode",t["onConfirmation"]="onConfirmation",t["invalidCode"]="invalidCode",t["wrongCode"]="wrongCode",t["startSignError"]="startSignError",t["confirmationError"]="confirmationError",t["signIsSucceed"]="signIsSucceed"}(Ps||(Ps={}));const Hs=(0,Ds.C)({initial:Ps.initial,states:{[Ps.initial]:{on:{[As.startSign]:Ps.onSignStart}},[Ps.onSignStart]:{on:{[As.success]:Ps.waitingCodeInput,[As.startSignError]:Ps.startSignError}},[Ps.startSignError]:{on:{[As.retryStart]:Ps.onSignStart}},[Ps.waitingCodeInput]:{on:{[As.confirm]:Ps.onConfirmation}},[Ps.onConfirmation]:{on:{[As.invalidCode]:Ps.invalidCode,[As.success]:Ps.signIsSucceed,[As.wrongCodeError]:Ps.wrongCode,[As.confirmationError]:Ps.confirmationError}},[Ps.invalidCode]:{on:{[As.resetCodeValidation]:Ps.waitingCodeInput}},[Ps.wrongCode]:{on:{[As.resetCodeValidation]:Ps.waitingCodeInput}},[Ps.confirmationError]:{on:{[As.retryConfirm]:Ps.onConfirmation}},[Ps.signIsSucceed]:{}}}),Ts=1;let Os=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"source",void 0),(0,f.Z)(this,"requestId",null),(0,f.Z)(this,"pinCodeValue",["","","","","",""]),(0,f.Z)(this,"resendCounter",null),(0,f.Z)(this,"resendDuration",null),(0,f.Z)(this,"canRestartSign",!1),(0,f.Z)(this,"errorMessage",""),(0,f.Z)(this,"stateService",(0,Fs.kJ)(Hs)),(0,f.Z)(this,"currentState",Hs.initialState),(0,f.Z)(this,"State",Ps)}created(){this.stateService.onTransition((t=>{this.currentState=t})).start()}mounted(){this.startSign()}async startSign(){if(!this.source.rejected&&!this.source.signed){this.canRestartSign=!1,this.stateService.send(As.startSign);try{this.requestId=await this.$hrLinkRepository.startSign(this.source.id),this.startTimer(),this.stateService.send(As.success)}catch(t){this.errorMessage=t.response?.data?.message||"При попытке подписании документа произошла ошибка",this.stateService.send(As.startSignError),this.$store.dispatch("reportError",t)}}}async confirm(){try{if(!this.requestId)throw Error("requestId must be set before confirmation");this.stateService.send(As.confirm);const t=this.validate();t?(await this.$hrLinkRepository.confirmSign(this.source.id,this.requestId,this.code),this.stateService.send(As.success),this.$emit("signed")):this.stateService.send(As.invalidCode)}catch(t){this.stateService.send(As.confirmationError),this.errorMessage=t.response?.data?.message||"При попытке подписании документа произошла ошибка",this.$store.dispatch("reportError",t)}}async restart(){await this.startSign()}resetPinCodeError(){this.stateService.send(As.resetCodeValidation)}goToList(){const t=[{type:qe.filter,params:{visible:!0}}],e=(0,ft.Rg)(this.$store.getters["platform"],{},"Мои документы",t);document.location.href=e}validate(){let t=!0;return(!this.code||this.code.length<6)&&(t=!1),t}startTimer(){const t=js.ou.local().plus({minutes:Ts}),e=()=>{this.resendDuration=this.getDiff(t),(this.resendDuration?.seconds??0)<=1&&(this.canRestartSign=!0,clearInterval(this.resendCounter||0))};this.resendCounter=setInterval(e,1e3),e()}getDiff(t){return t.diff(js.ou.local(),"seconds")}get time(){return this.resendDuration?.toFormat("mm:ss")}get code(){return this.pinCodeValue.join("")}get isBusy(){return this.currentState.matches(Ps.onConfirmation)||this.currentState.matches(Ps.onSignStart)}get isPinCodeError(){return this.currentState.matches(Ps.wrongCode)||this.currentState.matches(Ps.invalidCode)}get isError(){return this.currentState.matches(Ps.startSignError)||this.currentState.matches(Ps.confirmationError)}};(0,l.gn)([(0,u.fI)({required:!0})],Os.prototype,"source",void 0),(0,l.gn)([(0,u.RL)("pinCodeValue")],Os.prototype,"resetPinCodeError",null),Os=(0,l.gn)([(0,u.wA)({components:{DocumentInfo:vs,PinCode:ls,Button1:Ct.Z,BackgroundIconError:Ue.Z,BackgroundIconSuccess:Zs,BackgroundIconKey:Ms}})],Os);var $s=Os,Bs=$s,Vs=(0,x.Z)(Bs,es,ss,!1,null,null,null),Ns=Vs.exports,zs=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-view"},[e("div",{staticClass:"document-view__padding"},[e("document-info",{attrs:{source:t.source}}),t.source.rejected&&t.source.rejectionComment?e("document-comment-view",{staticClass:"document-view__comment",attrs:{rawText:t.source.rejectionComment,mayBeExpanded:!0}}):t._e()],1),e("pdf-viewer",{staticClass:"document-view__pdf",attrs:{id:t.source.id,name:t.source.name},on:{done:function(e){t.loading=!1}}}),t.showFooter?e("footer",{staticClass:"document-view__footer"},[e("button-1",{on:{click:t.sign}},[t._v("Подписать")]),e("button-1",{attrs:{color:"#ffffff",textColor:"#F39420"},on:{click:t.reject}},[t._v("Отклонить")])],1):t._e(),t.loading?e("background-spinner"):t._e()],1)},Us=[],qs=s(3686),Ks=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"pdf-viewer"},[e("div",{staticClass:"pdf-viewer__actions"},[e("button",{attrs:{id:t.idConfig.zoomIn,type:"button",title:"Zoom in"}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none"}},[e("path",{attrs:{fill:"#FFB400",d:"M11.435 10.063h-.723l-.256-.247a5.92 5.92 0 0 0 1.437-3.87 5.946 5.946 0 1 0-5.947 5.947 5.92 5.92 0 0 0 3.87-1.437l.247.256v.723L14.637 16 16 14.637l-4.565-4.574Zm-5.489 0A4.111 4.111 0 0 1 1.83 5.946 4.111 4.111 0 0 1 5.946 1.83a4.111 4.111 0 0 1 4.117 4.116 4.111 4.111 0 0 1-4.117 4.117Zm.458-6.404h-.915v1.83h-1.83v.915h1.83v1.83h.915v-1.83h1.83v-.915h-1.83v-1.83Z"}})])]),e("button",{attrs:{id:t.idConfig.zoomOut,type:"button",title:"Zoom out"}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none"}},[e("path",{attrs:{fill:"#FFB400",d:"M11.435 10.063h-.723l-.256-.247a5.92 5.92 0 0 0 1.437-3.87 5.946 5.946 0 1 0-5.947 5.947 5.92 5.92 0 0 0 3.87-1.437l.247.256v.723L14.637 16 16 14.637l-4.565-4.574Zm-5.489 0A4.111 4.111 0 0 1 1.83 5.946 4.111 4.111 0 0 1 5.946 1.83a4.111 4.111 0 0 1 4.117 4.116 4.111 4.111 0 0 1-4.117 4.117Zm.458-4.574H3.659v.915h4.575v-.915h-1.83Z"}})])]),e("button",{attrs:{type:"button",title:"Download"},on:{click:t.download}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",fill:"none"}},[e("path",{attrs:{fill:"#FFB400",d:"M14 5.647h-4V0H4v5.647H0l7 6.588 7-6.588ZM6 7.53V1.882h2V7.53h1.17L7 9.572 4.83 7.529H6Zm-6 6.589h14V16H0v-1.882Z"}})])])]),e("div",{staticClass:"pdf-viewer__container"},[t.blobUrl?e("vue-pdf-app",{staticClass:"pdf-viewer__app",staticStyle:{position:"relative"},attrs:{pdf:t.blobUrl,config:{toolbar:!1,sidebar:!1,presentationMode:!0},"page-scale":"page-width","id-config":t.idConfig}}):t._e()],1)])},Ws=[],Gs=s(2506),Js=s.n(Gs);let Qs=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"id",void 0),(0,f.Z)(this,"name",void 0),(0,f.Z)(this,"idConfig",{zoomIn:"vuePdfAppZoomIn",zoomOut:"vuePdfAppZoomOut"}),(0,f.Z)(this,"blobUrl",""),(0,f.Z)(this,"filebase64String","")}async mounted(){try{const t=await this.$hrLinkRepository.getDocumentFile(this.id),e=new FileReader;e.onloadend=()=>{this.filebase64String=e.result},e.readAsDataURL(t);const s=new window.Blob([t],{type:"application/pdf"});this.blobUrl=window.URL.createObjectURL(s)}catch(t){this.$store.dispatch("reportError",t)}finally{this.$emit("done")}}download(){const t=this.$store.getters["platform"],e=this.name+".pdf";if("Web"===t){let t=document.createElement("a");t.download=e,t.target="_blank",t.href=this.blobUrl,document.body.appendChild(t),t.click()}else if("iOS"===t)try{window.webkit.messageHandlers.openFromDataUrl.postMessage?.({fileName:e,data:this.filebase64String})}catch(s){this.$store.dispatch("reportError",s)}else appercode.openFromDataUrl(this.data,e,"application/pdf")}beforeDestroy(){window.URL.revokeObjectURL(this.blobUrl)}};(0,l.gn)([(0,u.fI)({required:!0})],Qs.prototype,"id",void 0),(0,l.gn)([(0,u.fI)({required:!0})],Qs.prototype,"name",void 0),Qs=(0,l.gn)([(0,u.wA)({components:{VuePdfApp:Js()}})],Qs);var Ys=Qs,Xs=Ys,ti=(0,x.Z)(Xs,Ks,Ws,!1,null,null,null),ei=ti.exports;let si=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"source",void 0),(0,f.Z)(this,"loading",!0)}sign(){const t=(0,ft.Rg)(this.$store.getters["platform"],{id:this.source.id,isSign:"true"},this.source.type);document.location.href=t}reject(){const t=(0,ft.Rg)(this.$store.getters["platform"],{id:this.source.id,isReject:"true"},this.source.type);document.location.href=t}get showFooter(){const{rejected:t,signed:e}=this.source;return!t&&!e}};(0,l.gn)([(0,u.fI)({required:!0})],si.prototype,"source",void 0),si=(0,l.gn)([(0,u.wA)({components:{DocumentInfo:vs,PdfViewer:ei,DocumentCommentView:ht,Button1:Ct.Z,BackgroundSpinner:qs.Z}})],si);var ii=si,ri=ii,oi=(0,x.Z)(ri,zs,Us,!1,null,null,null),ni=oi.exports,ai=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-reject"},[t.rejected||t.error?t._e():[e("div",{staticClass:"document-reject__container"},[e("div",{staticClass:"document-reject__title"},[e("p",[t._v('Вы действительно хотите отказаться подписывать документ: "'+t._s(t.source.type)+'"?')])]),e("document-info",{attrs:{source:t.source}}),e("div",{staticClass:"document-reject__reason"},[e("p",[t._v("Укажите причину:")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reason,expression:"reason"}],attrs:{placeholder:"Введите сообщение",rows:"9"},domProps:{value:t.reason},on:{input:function(e){e.target.composing||(t.reason=e.target.value)}}}),t.validationError?e("span",[t._v("Поле причины обязательно")]):t._e()])],1),e("footer",{staticClass:"document-reject__footer"},[e("button-1",{on:{click:t.reject}},[t._v("Отказаться")])],1)],t.rejected?[e("background-icon-error",[e("p",[t._v("Ваш отказ отправлен!")])]),e("footer",{staticClass:"document-reject__footer"},[e("button-1",{on:{click:t.goToList}},[t._v("К списку документов")])],1)]:t._e(),t.error?[e("background-icon-error",[e("p",[t._v("При отказе от подписи документа произошла ошибка")])]),e("footer",{staticClass:"document-reject__footer"},[e("button-1",{on:{click:t.reject}},[t._v("Попробовать снова")])],1)]:t._e()],2)},ci=[];let li=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"source",void 0),(0,f.Z)(this,"reason",""),(0,f.Z)(this,"validationError",!1),(0,f.Z)(this,"rejected",!1),(0,f.Z)(this,"error",!1)}async reject(){this.error=!1,this.validationError=!1;try{if(!this.reason)return void(this.validationError=!0);await this.$hrLinkRepository.rejectSign(this.source.id,this.reason),this.rejected=!0}catch(t){this.error=!0,this.$store.dispatch("reportError",t)}}goToList(){const t=[{type:qe.filter,params:{visible:!0}}],e=(0,ft.Rg)(this.$store.getters["platform"],{},"Мои документы",t);document.location.href=e}watchReason(){this.validationError=!1}};(0,l.gn)([(0,u.fI)({required:!0})],li.prototype,"source",void 0),(0,l.gn)([(0,u.RL)("reason")],li.prototype,"watchReason",null),li=(0,l.gn)([(0,u.wA)({components:{Button1:Ct.Z,DocumentInfo:vs,BackgroundIconError:Ue.Z}})],li);var ui=li,di=ui,hi=(0,x.Z)(di,ai,ci,!1,null,null,null),fi=hi.exports;let pi=class extends u.w3{constructor(...t){super(...t),(0,f.Z)(this,"id",void 0),(0,f.Z)(this,"item",null),(0,f.Z)(this,"isError",!1)}created(){this.load()}async load(){try{const t=await this.$hrLinkRepository.getDocument(this.id);this.item=t,this.isError=!1}catch(t){this.isError=!0}}get isSign(){return"true"===(this.$store.getters["urlParam"]("isSign")??"")}get isReject(){return"true"===(this.$store.getters["urlParam"]("isReject")??"")}};(0,l.gn)([(0,u.fI)({required:!0})],pi.prototype,"id",void 0),pi=(0,l.gn)([(0,u.wA)({components:{DocumentView:ni,BackgroundIconError:Ue.Z,DocumentSign:Ns,DocumentReject:fi}})],pi);var gi=pi,vi=gi,mi=(0,x.Z)(vi,Xe,ts,!1,null,null,null),_i=mi.exports;let wi=class extends u.w3{created(){const t=Object.fromEntries(new URL(window.location.toString()).searchParams.entries());this.$store.commit("setUrlParams",t)}get id(){return this.$store.getters["urlParam"]("id")??""}};wi=(0,l.gn)([(0,u.wA)({components:{DocumentsList:Ye,DocumentDetail:_i}})],wi);var yi=wi,Si=yi,Ci=(0,x.Z)(Si,a,c,!1,null,null,null),xi=Ci.exports;i["default"].config.productionTip=!1,i["default"].use(r.Z),i["default"].use(o.ZP);const Zi=(0,n.p)(xi);Zi.$mount("#app")},3109:function(t,e,s){"use strict";s.d(e,{WS:function(){return i},dx:function(){return r}});const i=t=>{const e=JSON.stringify(t);void 0!==window.webkit&&void 0!==window.webkit.messageHandlers.changeButtons&&window.webkit.messageHandlers.changeButtons.postMessage(e),void 0!==window.actor&&window.actor.changeButtons(e)},r=()=>{void 0!=window.webkit&&void 0!=window.webkit.messageHandlers.session&&window.webkit.messageHandlers.session.postMessage("refresh"),void 0!=window.session&&window.session.postMessage("refresh")}},2868:function(){},4777:function(){},9830:function(){},209:function(){},7414:function(){}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=t,function(){s.amdO={}}(),function(){var t=[];s.O=function(e,i,r,o){if(!i){var n=1/0;for(u=0;u<t.length;u++){i=t[u][0],r=t[u][1],o=t[u][2];for(var a=!0,c=0;c<i.length;c++)(!1&o||n>=o)&&Object.keys(s.O).every((function(t){return s.O[t](i[c])}))?i.splice(c--,1):(a=!1,o<n&&(n=o));if(a){t.splice(u--,1);var l=r();void 0!==l&&(e=l)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[i,r,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){s.j=981}(),function(){var t={981:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var r,o,n=i[0],a=i[1],c=i[2],l=0;if(n.some((function(e){return 0!==t[e]}))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(c)var u=c(s)}for(e&&e(i);l<n.length;l++)o=n[l],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(u)},i=self["webpackChunkugmk_documents"]=self["webpackChunkugmk_documents"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998,64],(function(){return s(5343)}));i=s.O(i)})();