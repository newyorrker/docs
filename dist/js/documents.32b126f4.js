(function(){"use strict";var t={4542:function(t,e,s){var r,o=s(538),i=s(6234),n=s(1251),c=s(1980),a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"app"}},[t.id?e("document-detail",{attrs:{id:t.id}}):e("documents-list")],1)},l=[],u=s(655),d=s(140),h=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"documents-list"},[t.showFilterButton?e("button",{on:{click:function(e){t.showFilter=!0}}},[t._v("Show filter")]):t._e(),e("easy-refresh",{ref:"easyRefresh",staticClass:"documents-list__refresh",class:{"documents-list__refresh_error":t.isError},attrs:{"on-refresh":t.refresh,loadMore:t.loadMore,autoLoad:!0,userSelect:"false",showScrollBar:!0},scopedSlots:t._u([{key:"header",fn:function(){return[e("ClassicsHeader",{attrs:{finishDuration:0,refreshedText:"",refreshingText:t.$t("common.refreshingText"),refreshText:t.$t("common.pullToRefreshPrompt"),refreshReadyText:t.$t("common.releaseToRefreshPrompt")}})]},proxy:!0},{key:"footer",fn:function(){return[e("EmptyFooter")]},proxy:!0},{key:"scrollbar",fn:function(){return[e("ClassicsScrollBar",{attrs:{color:"rgba(0, 0, 0, 0.3)",bgColor:"transparent",width:"3",radius:"2"}})]},proxy:!0}])},[t.isError?e("background-icon-error",[e("p",[t._v("При загрузке списка документов произошла ошибка")])]):[t.showList?e("div",{staticClass:"documents-list__list",class:{"documents-list__list_bordered":t.showSkel}},t._l(t.items,(function(s){return e("document-card",{key:s.id,attrs:{title:s.type,source:s},nativeOn:{click:function(e){return t.openItem(s)}}})})),1):t._e(),e("documents-list-skel",{directives:[{name:"show",rawName:"v-show",value:t.showSkel,expression:"showSkel"}],staticClass:"documents-list__skel"})]],2),!t.showList||t.items.length||t.showSkel||t.isError?t._e():e("div",{staticClass:"documents-list__empty"},[t._v(" Список документов пуст ")]),e("keep-alive",[t.showFilter?e("documents-list-filter",{staticClass:"documents-list__filter",on:{apply:t.applyFilter,close:function(e){t.showFilter=!1}}}):t._e()],1)],1)},f=[],p=s(6318),g=s(3380),m=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"documents-list-filter"},[e("div",{staticClass:"documents-list-filter__container"},[e("header",{staticClass:"documents-list-filter__header"},[e("div",{staticClass:"documents-list-filter__reset"},[e("button",{on:{click:t.reset}},[t._v("Сбросить")])]),t._m(0),e("div",{staticClass:"documents-list-filter__close"},[e("button",{on:{click:function(e){return t.$emit("close")}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none"}},[e("path",{attrs:{fill:"#373737",d:"M7.05 5.636 18.364 16.95l-1.414 1.414L5.636 7.05z"}}),e("path",{attrs:{fill:"#373737",d:"m16.95 5.636 1.414 1.414L7.05 18.364 5.636 16.95z"}})])])])]),e("main",[e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v(" Период публикации ")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__date"},[e("date-input",{model:{value:t.dateLeft,callback:function(e){t.dateLeft=e},expression:"dateLeft"}}),t._v(" — "),e("date-input",{model:{value:t.dateRight,callback:function(e){t.dateRight=e},expression:"dateRight"}})],1)]),e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v("Статус документа")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__status"},t._l(t.statuses,(function(s){return e("status-tag",{key:s.id,attrs:{active:s.isActive},on:{toggle:function(t){s.isActive=!s.isActive}},scopedSlots:t._u([{key:"icon",fn:function(){return[e(s.iconName,{tag:"component",attrs:{inverted:s.isActive}})]},proxy:!0}],null,!0)},[t._v(" "+t._s(s.title)+" ")])})),1)]),e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v("Статус документа для пользователя")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__status"},t._l(t.employeeSignerStatuses,(function(s){return e("status-tag",{key:s.id,attrs:{active:s.isActive},on:{toggle:function(t){s.isActive=!s.isActive}},scopedSlots:t._u([{key:"icon",fn:function(){return[e(s.iconName,{tag:"component",attrs:{inverted:s.isActive}})]},proxy:!0}],null,!0)},[t._v(" "+t._s(s.title)+" ")])})),1)]),e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v("Статус документа для руководителя")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__status"},t._l(t.headSignerStatuses,(function(s){return e("status-tag",{key:s.id,attrs:{active:s.isActive},on:{toggle:function(t){s.isActive=!s.isActive}},scopedSlots:t._u([{key:"icon",fn:function(){return[e(s.iconName,{tag:"component",attrs:{inverted:s.isActive}})]},proxy:!0}],null,!0)},[t._v(" "+t._s(s.title)+" ")])})),1)])],1)]),e("footer",[e("button-1",{on:{click:t.apply}},[t._v("Применить")])],1)])},v=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"documents-list-filter__title"},[e("span",[t._v("Фильтр")])])}],_=s(6226),y=s(9828),S=s(9526),w=s(9505);(function(t){t["draft"]="DRAFT",t["inProcess"]="IN_PROCESS",t["completed"]="COMPLETED",t["rejected"]="REJECTED",t["deleted"]="DELETED",t["notSeen"]="NOT_SEEN",t["seen"]="SEEN",t["signed"]="SIGNED"})(r||(r={}));const Z=()=>[{id:r.completed,title:"Завершен",isActive:!1,iconName:"document-check-icon"},{id:r.rejected,title:"Отменен",isActive:!1,iconName:"cross-icon"},{id:r.inProcess,title:"В процессе",isActive:!1,iconName:"document-progress-icon"}],k=()=>[{id:r.notSeen,title:"Не просмотрен",isActive:!1,iconName:"eye-strikethrough-icon"},{id:r.seen,title:"Просмотрен",isActive:!1,iconName:"eye-icon"},{id:r.rejected,title:"Отклонен",isActive:!1,iconName:"cross-icon"},{id:r.signed,title:"Подписан",isActive:!1,iconName:"apply-icon"}];var C=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{staticClass:"outlined-eye-svg",attrs:{width:"15",height:"15",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[e("path",{attrs:{fill:t.color,d:"M19.337 9.787A10.431 10.431 0 0 0 10 3.125 10.431 10.431 0 0 0 .662 9.787a.625.625 0 0 0 0 .425A10.431 10.431 0 0 0 10 16.876a10.431 10.431 0 0 0 9.337-6.662.625.625 0 0 0 0-.425ZM10 15.625c-3.313 0-6.813-2.456-8.081-5.625C3.187 6.831 6.687 4.375 10 4.375c3.313 0 6.813 2.456 8.081 5.625-1.268 3.169-4.768 5.625-8.081 5.625Zm0-9.375a3.75 3.75 0 1 0 0 7.5 3.75 3.75 0 0 0 0-7.5Zm0 6.25a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z"}})])},x=[];let E=class extends d.w3{constructor(...t){super(...t),(0,p.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#373737"}};(0,u.gn)([(0,d.fI)()],E.prototype,"inverted",void 0),E=(0,u.gn)([d.wA],E);var b=E,D=b,A=s(1001),L=(0,A.Z)(D,C,x,!1,null,null,null),I=L.exports,j=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{staticClass:"outlined-stroked-eye-svg",attrs:{width:"15",height:"15",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[e("path",{attrs:{fill:t.color,d:"m3.275 14.069.894-.888A8.788 8.788 0 0 1 1.919 10C3.187 6.831 6.687 4.375 10 4.375a7.738 7.738 0 0 1 2.5.45l.969-.975A9.2 9.2 0 0 0 10 3.125 10.431 10.431 0 0 0 .662 9.787a.625.625 0 0 0 0 .425 10 10 0 0 0 2.613 3.857ZM7.5 9.83A2.5 2.5 0 0 1 9.813 7.52l1.13-1.138a3.75 3.75 0 0 0-4.58 4.582L7.5 9.83Zm11.837-.043a10.25 10.25 0 0 0-3.587-4.65l3-3.007-.881-.881L1.25 17.869l.881.881 3.188-3.188A9.556 9.556 0 0 0 10 16.875a10.431 10.431 0 0 0 9.337-6.662.625.625 0 0 0 0-.425ZM12.5 10a2.5 2.5 0 0 1-3.75 2.15l3.4-3.4A2.5 2.5 0 0 1 12.5 10ZM10 15.625a8.156 8.156 0 0 1-3.75-.988l1.588-1.587a3.75 3.75 0 0 0 5.218-5.219l1.794-1.794A9.087 9.087 0 0 1 18.081 10c-1.268 3.169-4.768 5.625-8.081 5.625Z"}})])},T=[];let R=class extends d.w3{constructor(...t){super(...t),(0,p.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#f3f3f3":"#b9bfc7"}};(0,u.gn)([(0,d.fI)()],R.prototype,"inverted",void 0),R=(0,u.gn)([d.wA],R);var P=R,O=P,F=(0,A.Z)(O,j,T,!1,null,null,null),N=F.exports,M=s(3088),$=s(4434),B=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"13",fill:"none"}},[e("path",{attrs:{fill:t.color,d:"M10.118 5.571V3.714a.43.43 0 0 0-.037-.178.463.463 0 0 0-.109-.152L6.431.134A.546.546 0 0 0 6.07 0h-5.06C.454 0 0 .416 0 .929V12.07c0 .513.453.929 1.012.929h8.095c.558 0 1.011-.416 1.011-.929v-.928H9.107v.928H1.012V.93h4.047v2.785c0 .513.454.929 1.012.929h3.036v.928h1.011ZM6.071 3.714V1.12L8.9 3.714H6.071Z"}}),e("path",{attrs:{fill:t.color,"fill-rule":"evenodd",d:"m11.267 6.656-4.06 4.07a.549.549 0 0 1-.395.157.547.547 0 0 1-.39-.166L4.114 8.29l.794-.635 1.92 2.02 3.662-3.671.777.652Z","clip-rule":"evenodd"}})])},V=[];let H=class extends d.w3{constructor(...t){super(...t),(0,p.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#373737"}};(0,u.gn)([(0,d.fI)()],H.prototype,"inverted",void 0),H=(0,u.gn)([d.wA],H);var q=H,G=q,W=(0,A.Z)(G,B,V,!1,null,null,null),U=W.exports,z=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"11",height:"13",fill:"none"}},[e("path",{attrs:{fill:t.color,d:"M11 7.893H4.964L6.146 6.69 5.5 6.036 3.208 8.357 5.5 10.68l.646-.655-1.182-1.203H11v-.928ZM9.167 5.57V3.714a.47.47 0 0 0-.133-.33L5.826.134A.458.458 0 0 0 5.5 0H.917A.923.923 0 0 0 0 .929V12.07c0 .513.41.929.917.929H8.25a.923.923 0 0 0 .917-.929v-.928H8.25v.928H.917V.93h3.666v2.785c0 .513.411.929.917.929h2.75v.928h.917ZM5.5 3.714V1.12l2.562 2.595H5.5Z"}})])},Q=[];let J=class extends d.w3{constructor(...t){super(...t),(0,p.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#373737"}};(0,u.gn)([(0,d.fI)()],J.prototype,"inverted",void 0),J=(0,u.gn)([d.wA],J);var K=J,X=K,Y=(0,A.Z)(X,z,Q,!1,null,null,null),tt=Y.exports,et=s(5213);let st=class extends et.Z{constructor(...t){super(...t),(0,p.Z)(this,"dateLeft",""),(0,p.Z)(this,"dateRight",""),(0,p.Z)(this,"statuses",Z()),(0,p.Z)(this,"employeeSignerStatuses",k()),(0,p.Z)(this,"headSignerStatuses",k())}apply(){this.$emit("apply",this.filterState),this.$emit("close")}reset(){this.dateLeft="",this.dateRight="",this.statuses=Z(),this.employeeSignerStatuses=k(),this.headSignerStatuses=k(),this.apply()}get filterState(){return{documentDateFrom:this.dateLeft,documentDateTo:this.dateRight,statuses:this.statuses.filter((t=>t.isActive)).map((t=>t.id)),employeeSignerStatuses:this.employeeSignerStatuses.filter((t=>t.isActive)).map((t=>t.id)),headSignerStatuses:this.headSignerStatuses.filter((t=>t.isActive)).map((t=>t.id))}}};st=(0,u.gn)([(0,d.wA)({components:{DateInput:_.Z,Button1:y.Z,DocumentListFilterSection:S.Z,DocumentsListFilterSection:S.Z,StatusTag:w.Z,EyeIcon:I,EyeStrikethroughIcon:N,CrossIcon:M.Z,ApplyIcon:$.Z,DocumentCheckIcon:U,DocumentProgressIcon:tt}})],st);var rt=st,ot=rt,it=(0,A.Z)(ot,m,v,!1,null,null,null),nt=it.exports,ct=s(7499),at=s(9669),lt=s.n(at);class ut{constructor(t,e){(0,p.Z)(this,"queryFabric",void 0),(0,p.Z)(this,"hrLinkRepository",void 0),(0,p.Z)(this,"cancelToken",void 0),this.queryFabric=t,this.hrLinkRepository=e}async load(t){const e=this.queryFabric.getQuery(t);return this.cancelToken&&this.cancelToken.cancel(),this.cancelToken=lt().CancelToken.source(),await this.hrLinkRepository.getDocuments(e,{cancelToken:this.cancelToken.token})}}class dt{constructor(t){(0,p.Z)(this,"pagingState",void 0),this.pagingState=t}getQuery(t){let e=t;const s={take:this.pagingState.take,skip:this.pagingState.skip,where:e};return s}}var ht=s(5423),ft=s(1671),pt=s(1390),gt=s(3109),mt=s(3586);let vt=class extends mt.Z{constructor(...t){super(...t),(0,p.Z)(this,"documentsListService",void 0),(0,p.Z)(this,"filterState",{documentDateFrom:"",documentDateTo:"",statuses:[],employeeSignerStatuses:[],headSignerStatuses:[]})}created(){this.documentsListService=new ut(new dt(this.pagingState),this.$hrLinkRepository)}async getList(t=!1){this.isLoading=!0,this.resetEasyRefreshScroll(),this.pagingState.skip=t?this.items?.length??0:0;try{const e=await this.documentsListService.load(this.filterState);if(this.isError=!1,t&&this.items?this.items=[...this.items,...e]:this.items=e,e.length<this.pagingState.take)return!0}catch(e){this.isError=!0,this.$store.dispatch("reportError",e)}finally{this.isLoading=!1,this.loaded=!0}return!1}buttonClicked(t){t===pt.Z.filter&&(this.showFilter=!0)}openItem(t){const e=(0,ht.Rg)(this.$store.getters["platform"],{id:t.id},t.type);document.location.href=e}applyFilter(t){this.filterState=t,(0,gt.WS)([{type:pt.Z.filter,params:{filtered:this.filterHasValue}}]),this.items=[],this.getList()}get filterHasValue(){const{documentDateFrom:t,documentDateTo:e,statuses:s,employeeSignerStatuses:r,headSignerStatuses:o}=this.filterState;return!!t||!!e||!!s?.length||!!r?.length||!!o?.length}get showFilterButton(){return"Web"===this.$store.getters["platform"]}};vt=(0,u.gn)([(0,d.wA)({components:{DocumentCard:g.Z,DocumentsListFilter:nt,DocumentsListSkel:ct.Z,BackgroundIconError:ft.Z}})],vt);var _t=vt,yt=_t,St=(0,A.Z)(yt,h,f,!1,null,null,null),wt=St.exports,Zt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-detail"},[!t.isError&&t.item?[t.isSign||t.isReject?[t.isSign?e("document-sign",{attrs:{source:t.item,id:t.item.id,defaultErrorMessage:"При попытке подписания документа произошла ошибка"},on:{signed:t.load}}):t._e(),t.isReject?e("document-reject",{attrs:{source:t.item}}):t._e()]:e("document-view",{attrs:{source:t.item}})]:t.isError?e("background-icon-error",[e("p",[t._v("При загрузке документа произошла ошибка")])]):t._e()],2)},kt=[],Ct=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-sign"},[t.showMain?[e("div",{staticClass:"document-sign__container"},[e("sign-title",{attrs:{title:t.source.type,type:"документ"}}),e("document-info",{attrs:{source:t.source}}),e("pin-code",{attrs:{error:t.isPinCodeError},on:{filled:t.filled},model:{value:t.pinCodeValue,callback:function(e){t.pinCodeValue=e},expression:"pinCodeValue"}}),e("sign-troubleshooting",{attrs:{codeIsWrong:t.currentState.matches(t.State.wrongCode),canRestartSign:t.canRestartSign,time:t.time},on:{restart:t.restart}})],1),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{attrs:{disabled:t.isPinCodeError},on:{click:t.confirm}},[t._v("Подтвердить")])],1)]:t._e(),t.onSendingTheCode||t.onSignStart?e("sign-loading",{attrs:{type:"документ",showText:t.onSendingTheCode}}):t._e(),t.onSigning?e("sign-loading",{attrs:{verb:"Идет",type:"подписание...",showText:!0}}):t._e(),t.currentState.matches(t.State.startSignError)?[e("background-icon-error",[e("p",[t._v(t._s(t.errorMessage))])]),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.startSign}},[t._v("Повторить попытку")])],1)]:t._e(),t.currentState.matches(t.State.signError)||t.currentState.matches(t.State.signTimeIsOut)?[e("background-icon-error",[e("p",[t._v("Ошибка! "),e("br"),t._v(" "+t._s(t.errorMessage))])]),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.confirm}},[t._v("Повторить попытку")])],1)]:t._e(),t.currentState.matches(t.State.signIsSucceed)?[e("background-icon-success",[e("p",[t._v("Вы подписали документ!")])]),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.goToList}},[t._v("К списку документов")])],1)]:t._e()],2)},xt=[],Et=s(388),bt=s(2027),Dt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-info"},[t.source.creator?e("user-profile",{attrs:{userProfile:t.source.creator}}):t._e(),e("div",{staticClass:"document-info__text"},[e("p",[e("span",[t._v("Сформировано:")]),t._v(" "+t._s(t.creationDate)+" ")]),e("document-status",{staticClass:"document-info__status",attrs:{source:t.source,extended:t.useStatus}})],1)],1)},At=[],Lt=s(4503),It=s(6979),jt=s(7468);let Tt=class extends d.w3{constructor(...t){super(...t),(0,p.Z)(this,"source",void 0),(0,p.Z)(this,"useStatus",void 0)}get creationDate(){return(0,jt.p)(this.source.createdAt)}};(0,u.gn)([(0,d.fI)({required:!0})],Tt.prototype,"source",void 0),(0,u.gn)([(0,d.fI)({default:!0})],Tt.prototype,"useStatus",void 0),Tt=(0,u.gn)([(0,d.wA)({components:{UserProfile:Lt.Z,DocumentStatus:It.Z}})],Tt);var Rt,Pt=Tt,Ot=Pt,Ft=(0,A.Z)(Ot,Dt,At,!1,null,null,null),Nt=Ft.exports,Mt=s(2378),$t=s(3897),Bt=s(3987),Vt=s(7834),Ht=s(2504),qt=s(7583);(function(t){t["WAITING_CODE"]="WAITING_CODE",t["CONFIRMING"]="CONFIRMING",t["WRONG_CODE"]="WRONG_CODE",t["SUCCEEDED"]="SUCCEEDED",t["FAILED"]="FAILED"})(Rt||(Rt={}));let Gt=class extends Et.Z{constructor(...t){super(...t),(0,p.Z)(this,"source",void 0)}mounted(){this.source.rejected||this.source.signed||this.startSign()}filled(){this.confirm()}async startCheckTheSign(){const t=setInterval((async()=>{if(!this.requestId)return;const s=await this.$hrLinkRepository.getSignStatus(this.id,this.requestId);s!==Rt.WAITING_CODE&&s!==Rt.CONFIRMING&&(s===Rt.SUCCEEDED&&(this.stateService.send(qt.ju.success),this.$emit("signed")),s===Rt.FAILED&&this.stateService.send(qt.ju.error),s===Rt.WRONG_CODE&&this.stateService.send(qt.ju.wrongCodeError),clearTimeout(e),clearInterval(t))}),1e3),e=setTimeout((()=>{clearInterval(t),this.errorMessage="Время ожидания подписания вышло",this.stateService.send(qt.ju.tooLongOperation)}),6e4)}goToList(){const t=[{type:pt.Z.filter,params:{visible:!0}}],e=(0,ht.Rg)(this.$store.getters["platform"],{},"Мои документы",t);document.location.href=e}get onSigning(){return this.currentState.matches(qt.ZM.onSigning)}};(0,u.gn)([(0,d.fI)({required:!0})],Gt.prototype,"source",void 0),Gt=(0,u.gn)([(0,d.wA)({components:{DocumentInfo:Nt,PinCode:bt.Z,Button1:y.Z,BackgroundIconError:ft.Z,BackgroundIconSuccess:Mt.Z,BackgroundIconKey:$t.Z,SignTroubleshooting:Bt.Z,SignTitle:Vt.Z,SignLoading:Ht.Z}})],Gt);var Wt=Gt,Ut=Wt,zt=(0,A.Z)(Ut,Ct,xt,!1,null,null,null),Qt=zt.exports,Jt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-view"},[e("div",{staticClass:"document-view__padding"},[e("document-info",{attrs:{source:t.source}}),t.source.rejected&&t.source.rejectionComment?e("document-comment-view",{staticClass:"document-view__comment",attrs:{rawText:t.source.rejectionComment,mayBeExpanded:!0}}):t._e()],1),e("pdf-viewer",{staticClass:"document-view__pdf",attrs:{id:t.source.id,fileDataLoader:t.fileDataLoader,name:t.source.name},on:{done:function(e){t.loading=!1}}}),t.showFooter?e("footer",{staticClass:"document-view__footer"},[e("button-1",{on:{click:t.sign}},[t._v("Подписать")]),e("button-1",{attrs:{color:"#ffffff",textColor:"#F39420"},on:{click:t.reject}},[t._v("Отклонить")])],1):t._e(),t.loading?e("background-spinner"):t._e()],1)},Kt=[],Xt=s(946),Yt=s(9097);class te{constructor(t){(0,p.Z)(this,"repository",void 0),this.repository=t}load(t){return this.repository.getDocumentFile(t)}}var ee=s(4397);let se=class extends d.w3{constructor(...t){super(...t),(0,p.Z)(this,"source",void 0),(0,p.Z)(this,"fileDataLoader",new te(this.$hrLinkRepository)),(0,p.Z)(this,"loading",!0)}sign(){const t=(0,ht.Rg)(this.$store.getters["platform"],{id:this.source.id,isSign:"true"},this.source.type);document.location.href=t}reject(){const t=(0,ht.Rg)(this.$store.getters["platform"],{id:this.source.id,isReject:"true"},this.source.type);document.location.href=t}get showFooter(){const{rejected:t,signed:e}=this.source;return!t&&!e}};(0,u.gn)([(0,d.fI)({required:!0})],se.prototype,"source",void 0),se=(0,u.gn)([(0,d.wA)({components:{DocumentInfo:Nt,PdfViewer:Yt.Z,DocumentCommentView:ee.Z,Button1:y.Z,BackgroundSpinner:Xt.Z}})],se);var re=se,oe=re,ie=(0,A.Z)(oe,Jt,Kt,!1,null,null,null),ne=ie.exports,ce=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-reject"},[t.rejected||t.error?t._e():[e("div",{staticClass:"document-reject__container"},[e("div",{staticClass:"document-reject__title"},[e("p",[t._v('Вы действительно хотите отказаться подписывать документ: "'+t._s(t.source.type)+'"?')])]),e("document-info",{attrs:{source:t.source}}),e("div",{staticClass:"document-reject__reason"},[e("p",[t._v("Укажите причину:")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reason,expression:"reason"}],attrs:{placeholder:"Введите сообщение",rows:"9"},domProps:{value:t.reason},on:{input:function(e){e.target.composing||(t.reason=e.target.value)}}}),t.validationError?e("span",[t._v("Поле причины обязательно")]):t._e()])],1),e("footer",{staticClass:"document-reject__footer"},[e("button-1",{on:{click:t.reject}},[t._v("Отказаться")])],1)],t.rejected?[e("background-icon-error",[e("p",[t._v("Ваш отказ отправлен!")])]),e("footer",{staticClass:"document-reject__footer"},[e("button-1",{on:{click:t.goToList}},[t._v("К списку документов")])],1)]:t._e(),t.error?[e("background-icon-error",[e("p",[t._v("При отказе от подписи документа произошла ошибка")])]),e("footer",{staticClass:"document-reject__footer"},[e("button-1",{on:{click:t.reject}},[t._v("Попробовать снова")])],1)]:t._e()],2)},ae=[];let le=class extends d.w3{constructor(...t){super(...t),(0,p.Z)(this,"source",void 0),(0,p.Z)(this,"reason",""),(0,p.Z)(this,"validationError",!1),(0,p.Z)(this,"rejected",!1),(0,p.Z)(this,"error",!1)}async reject(){this.error=!1,this.validationError=!1;try{if(!this.reason)return void(this.validationError=!0);await this.$hrLinkRepository.rejectSign(this.source.id,this.reason),this.rejected=!0}catch(t){this.error=!0,this.$store.dispatch("reportError",t)}}goToList(){const t=[{type:pt.Z.filter,params:{visible:!0}}],e=(0,ht.Rg)(this.$store.getters["platform"],{},"Мои документы",t);document.location.href=e}watchReason(){this.validationError=!1}};(0,u.gn)([(0,d.fI)({required:!0})],le.prototype,"source",void 0),(0,u.gn)([(0,d.RL)("reason")],le.prototype,"watchReason",null),le=(0,u.gn)([(0,d.wA)({components:{Button1:y.Z,DocumentInfo:Nt,BackgroundIconError:ft.Z}})],le);var ue=le,de=ue,he=(0,A.Z)(de,ce,ae,!1,null,null,null),fe=he.exports;let pe=class extends d.w3{constructor(...t){super(...t),(0,p.Z)(this,"id",void 0),(0,p.Z)(this,"item",null),(0,p.Z)(this,"isError",!1)}created(){this.load()}async load(){try{const t=await this.$hrLinkRepository.getDocument(this.id);this.item=t,this.isError=!1}catch(t){this.isError=!0}}get isSign(){return"true"===(this.$store.getters["urlParam"]("isSign")??"")}get isReject(){return"true"===(this.$store.getters["urlParam"]("isReject")??"")}};(0,u.gn)([(0,d.fI)({required:!0})],pe.prototype,"id",void 0),pe=(0,u.gn)([(0,d.wA)({components:{DocumentView:ne,BackgroundIconError:ft.Z,DocumentSign:Qt,DocumentReject:fe}})],pe);var ge=pe,me=ge,ve=(0,A.Z)(me,Zt,kt,!1,null,null,null),_e=ve.exports;let ye=class extends d.w3{created(){const t=Object.fromEntries(new URL(window.location.toString()).searchParams.entries());this.$store.commit("setUrlParams",t)}get id(){return this.$store.getters["urlParam"]("id")??""}};ye=(0,u.gn)([(0,d.wA)({components:{DocumentsList:wt,DocumentDetail:_e}})],ye);var Se=ye,we=Se,Ze=(0,A.Z)(we,a,l,!1,null,null,null),ke=Ze.exports;o["default"].config.productionTip=!1,o["default"].use(i.Z),o["default"].use(n.ZP);const Ce=(0,c.p)(ke,"documents");Ce.$mount("#app")}},e={};function s(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,s),i.loaded=!0,i.exports}s.m=t,function(){s.amdO={}}(),function(){var t=[];s.O=function(e,r,o,i){if(!r){var n=1/0;for(u=0;u<t.length;u++){r=t[u][0],o=t[u][1],i=t[u][2];for(var c=!0,a=0;a<r.length;a++)(!1&i||n>=i)&&Object.keys(s.O).every((function(t){return s.O[t](r[a])}))?r.splice(a--,1):(c=!1,i<n&&(n=i));if(c){t.splice(u--,1);var l=o();void 0!==l&&(e=l)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[r,o,i]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={981:0};s.O.j=function(e){return 0===t[e]};var e=function(e,r){var o,i,n=r[0],c=r[1],a=r[2],l=0;if(n.some((function(e){return 0!==t[e]}))){for(o in c)s.o(c,o)&&(s.m[o]=c[o]);if(a)var u=a(s)}for(e&&e(r);l<n.length;l++)i=n[l],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(u)},r=self["webpackChunkugmk_documents"]=self["webpackChunkugmk_documents"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=s.O(void 0,[998,64],(function(){return s(4542)}));r=s.O(r)})();