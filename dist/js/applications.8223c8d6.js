(function(){"use strict";var t={2108:function(t,e,s){var i=s(538),r=s(6234),o=s(1251),n=s(1980),a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"app"}},[t.isApplicationCreate?e("application-create"):t.id?e("application-detail",{attrs:{id:t.id}}):e("applications-list")],1)},l=[],c=s(655),p=s(140),u=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"documents-list"},[t.showNewApplicationButton||t.showFilterButton?e("div",{staticClass:"documents-list__web-buttons"},[t.showNewApplicationButton?e("button",{on:{click:t.goToApplicationsCreate}},[t._v("Add new")]):t._e(),t.showFilterButton?e("button",{on:{click:function(e){t.showFilter=!0}}},[t._v("Show filter")]):t._e()]):t._e(),e("easy-refresh",{ref:"easyRefresh",staticClass:"documents-list__refresh",class:{"documents-list__refresh_error":t.isError},attrs:{"on-refresh":t.refresh,loadMore:t.loadMore,autoLoad:!0,userSelect:"false",showScrollBar:!0},scopedSlots:t._u([{key:"header",fn:function(){return[e("ClassicsHeader",{attrs:{finishDuration:0,refreshedText:"",refreshingText:t.$t("common.refreshingText"),refreshText:t.$t("common.pullToRefreshPrompt"),refreshReadyText:t.$t("common.releaseToRefreshPrompt")}})]},proxy:!0},{key:"footer",fn:function(){return[e("EmptyFooter")]},proxy:!0},{key:"scrollbar",fn:function(){return[e("ClassicsScrollBar",{attrs:{color:"rgba(0, 0, 0, 0.3)",bgColor:"transparent",width:"3",radius:"2"}})]},proxy:!0}])},[t.isError?e("background-icon-error",[e("p",[t._v("При загрузке списка документов произошла ошибка")])]):[t.showList?e("div",{staticClass:"documents-list__list",class:{"documents-list__list_bordered":t.showSkel}},t._l(t.items,(function(s){return e("document-card",{key:s.id,attrs:{title:s.typeName,source:s},nativeOn:{click:function(e){return t.openItem(s)}}})})),1):t._e(),e("documents-list-skel",{directives:[{name:"show",rawName:"v-show",value:t.showSkel,expression:"showSkel"}],staticClass:"documents-list__skel"})]],2),!t.showList||t.items.length||t.showSkel||t.isError?t._e():e("div",{staticClass:"documents-list__empty"},[t._v(" Список заявлений пуст ")]),e("keep-alive",[t.showFilter?e("applications-list-filter",{staticClass:"documents-list__filter",on:{apply:t.applyFilter,close:function(e){t.showFilter=!1}}}):t._e()],1)],1)},d=[],h=s(6318),f=s(3586),m=s(3380),v=s(7499),g=s(1671),_=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"documents-list-filter"},[e("div",{staticClass:"documents-list-filter__container"},[e("header",{staticClass:"documents-list-filter__header"},[e("div",{staticClass:"documents-list-filter__reset"},[e("button",{on:{click:t.reset}},[t._v("Сбросить")])]),t._m(0),e("div",{staticClass:"documents-list-filter__close"},[e("button",{on:{click:function(e){return t.$emit("close")}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none"}},[e("path",{attrs:{fill:"#373737",d:"M7.05 5.636 18.364 16.95l-1.414 1.414L5.636 7.05z"}}),e("path",{attrs:{fill:"#373737",d:"m16.95 5.636 1.414 1.414L7.05 18.364 5.636 16.95z"}})])])])]),e("main",[e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v(" Период публикации ")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__date"},[e("date-input",{model:{value:t.dateLeft,callback:function(e){t.dateLeft=e},expression:"dateLeft"}}),t._v(" — "),e("date-input",{model:{value:t.dateRight,callback:function(e){t.dateRight=e},expression:"dateRight"}})],1)]),e("documents-listFilter-section",{scopedSlots:t._u([{key:"header",fn:function(){return[t._v("Статус рассмотрения")]},proxy:!0}])},[e("div",{staticClass:"documents-list-filter__status"},t._l(t.statuses,(function(s){return e("status-tag",{key:s.id,attrs:{active:s.isActive},on:{toggle:function(t){s.isActive=!s.isActive}},scopedSlots:t._u([{key:"icon",fn:function(){return[e(s.iconName,{tag:"component",attrs:{inverted:s.isActive}})]},proxy:!0}],null,!0)},[t._v(" "+t._s(s.title)+" ")])})),1)])],1)]),e("footer",[e("button-1",{on:{click:t.apply}},[t._v("Применить")])],1)])},y=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"documents-list-filter__title"},[e("span",[t._v("Фильтр")])])}],w=s(6226),S=s(9828),Z=s(9526),A=s(5213),C=s(3088),x=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{attrs:{fill:t.color,xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13"}},[e("path",{attrs:{fill:t.color,d:"M12.207 6.056 1.22.556a.499.499 0 0 0-.54.06.5.5 0 0 0-.164.5L1.839 6h5.648v1H1.84L.496 11.873a.5.5 0 0 0 .5.63.5.5 0 0 0 .224-.055l10.987-5.5a.5.5 0 0 0 0-.89Z"}})])},I=[];let k=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#373737"}};(0,c.gn)([(0,p.fI)()],k.prototype,"inverted",void 0),k=(0,c.gn)([p.wA],k);var b=k,L=b,T=s(1001),E=(0,T.Z)(L,x,I,!1,null,null,null),F=E.exports,P=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"12",fill:"none"}},[e("path",{attrs:{fill:t.color,d:"M0 12 7.5 0 15 12H0Zm2.205-1.2h10.59L7.5 2.333 2.205 10.8Zm5.291-.8a.627.627 0 0 0 .447-.171.56.56 0 0 0 .182-.425.608.608 0 0 0-.621-.604.627.627 0 0 0-.447.171.56.56 0 0 0-.182.425.608.608 0 0 0 .621.604Zm-.621-2h1.25V4.8h-1.25V8Z"}})])},R=[];let D=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#373737"}};(0,c.gn)([(0,p.fI)()],D.prototype,"inverted",void 0),D=(0,c.gn)([p.wA],D);var $=D,N=$,M=(0,T.Z)(N,P,R,!1,null,null,null),O=M.exports,U=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"9",height:"12",fill:"none"}},[e("path",{attrs:{fill:t.color,d:"M2.063 10.875h4.874V9a2.35 2.35 0 0 0-.71-1.727 2.35 2.35 0 0 0-1.727-.71 2.35 2.35 0 0 0-1.727.71A2.35 2.35 0 0 0 2.063 9v1.875ZM0 12v-1.125h.938V9c0-.615.145-1.185.437-1.71A3.565 3.565 0 0 1 2.594 6a3.68 3.68 0 0 1-1.211-1.29A3.423 3.423 0 0 1 .937 3V1.125H0V0h9v1.125h-.938V3c0 .615-.148 1.185-.445 1.71A3.68 3.68 0 0 1 6.407 6c.52.333.926.763 1.218 1.29A3.47 3.47 0 0 1 8.063 9v1.875H9V12H0Z"}})])},V=[];let B=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"inverted",void 0)}get color(){return this.inverted?"#ffffff":"#373737"}};(0,c.gn)([(0,p.fI)()],B.prototype,"inverted",void 0),B=(0,c.gn)([p.wA],B);var j,H=B,G=H,W=(0,T.Z)(G,U,V,!1,null,null,null),q=W.exports,K=s(4434),z=s(9505);(function(t){t["PROCESSED"]="PROCESSED",t["REJECTED"]="REJECTED",t["CLAIMED"]="CLAIMED",t["WITHOUT_HR_MANAGER"]="WITHOUT_HR_MANAGER",t["WAITING_FOR_APPROVAL"]="WAITING_FOR_APPROVAL"})(j||(j={}));const J=()=>[{id:j.WAITING_FOR_APPROVAL,title:"На рассмотрении",isActive:!1,iconName:"hourglass-top"},{id:j.WITHOUT_HR_MANAGER,title:"Не требует рассмотрения ",isActive:!1,iconName:"warning"},{id:j.PROCESSED,title:"В процессе",isActive:!1,iconName:"paper-plane"},{id:j.REJECTED,title:"Отменен",isActive:!1,iconName:"cross-icon"},{id:j.CLAIMED,title:"Утверждено",isActive:!1,iconName:"apply-icon"}];let Q=class extends A.Z{constructor(...t){super(...t),(0,h.Z)(this,"dateLeft",""),(0,h.Z)(this,"dateRight",""),(0,h.Z)(this,"statuses",J())}apply(){this.$emit("apply",this.filterState),this.$emit("close")}reset(){this.dateLeft="",this.dateRight="",this.statuses=J(),this.apply()}get filterState(){return{applicationDateFrom:this.dateLeft,applicationDateTo:this.dateRight,hrManagerStatuses:this.statuses.filter((t=>t.isActive)).map((t=>t.id))}}};Q=(0,c.gn)([(0,p.wA)({components:{DateInput:w.Z,Button1:S.Z,DocumentsListFilterSection:Z.Z,StatusTag:z.Z,CrossIcon:C.Z,ApplyIcon:K.Z,HourglassTop:q,Warning:O,PaperPlane:F}})],Q);var X=Q,Y=X,tt=(0,T.Z)(Y,_,y,!1,null,null,null),et=tt.exports,st=s(5423),it=s(1390),rt=s(3109),ot=s(9669),nt=s.n(ot);class at{constructor(t,e){(0,h.Z)(this,"queryFabric",void 0),(0,h.Z)(this,"hrLinkRepository",void 0),(0,h.Z)(this,"cancelToken",void 0),this.queryFabric=t,this.hrLinkRepository=e}async load(t){const e=this.queryFabric.getQuery(t);return this.cancelToken&&this.cancelToken.cancel(),this.cancelToken=nt().CancelToken.source(),await this.hrLinkRepository.getApplications(e,{cancelToken:this.cancelToken.token})}}class lt{constructor(t){(0,h.Z)(this,"pagingState",void 0),this.pagingState=t}getQuery(t){const e={take:this.pagingState.take,skip:this.pagingState.skip,where:t};return e}}let ct=class extends f.Z{constructor(...t){super(...t),(0,h.Z)(this,"applicationsListService",void 0),(0,h.Z)(this,"filterState",{applicationDateFrom:"",applicationDateTo:"",hrManagerStatuses:[]})}created(){this.applicationsListService=new at(new lt(this.pagingState),this.$hrLinkRepository)}mounted(){window.clickButton=this.buttonClicked}destroyed(){window.clickButton=void 0}async getList(t=!1){this.isLoading=!0,this.resetEasyRefreshScroll(),this.pagingState.skip=t?this.items?.length??0:0;try{const e=await this.applicationsListService.load(this.filterState);if(this.isError=!1,t&&this.items?this.items=[...this.items,...e]:this.items=e,e.length<this.pagingState.take)return!0}catch(e){this.isError=!0,this.$store.dispatch("reportError",e)}finally{this.isLoading=!1,this.loaded=!0}return!1}openItem(t){const e=(0,st.Rg)(this.$store.getters["platform"],{id:t.applicationGroupId},t.typeName);document.location.href=e}applyFilter(t){this.filterState=t,(0,rt.WS)([{type:it.Z.filter,params:{filtered:this.filterHasValue}},{type:it.Z["new"],params:{}}]),this.items=[],this.getList()}goToApplicationsCreate(){const t=(0,st.Rg)(this.$store.getters["platform"],{isApplicationCreate:"true",isTypeSelect:"true"},"Создание заявления");document.location.href=t}buttonClicked(t){t===it.Z["new"]&&this.goToApplicationsCreate(),t===it.Z.filter&&(this.showFilter=!0)}get filterHasValue(){const{hrManagerStatuses:t,applicationDateFrom:e,applicationDateTo:s}=this.filterState;return!!t?.length||!!e||!!s}get showNewApplicationButton(){return"Web"===this.$store.getters["platform"]}get showFilterButton(){return"Web"===this.$store.getters["platform"]}};ct=(0,c.gn)([(0,p.wA)({components:{DocumentsListSkel:v.Z,DocumentCard:m.Z,BackgroundIconError:g.Z,ApplicationsListFilter:et}})],ct);var pt=ct,ut=pt,dt=(0,T.Z)(ut,u,d,!1,null,null,null),ht=dt.exports,ft=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"application-detal"},[!t.isError&&t.item?[t.isSign?e("application-sign",{attrs:{source:t.item,id:t.item.applicationGroupId,defaultErrorMessage:"При попытке подписания документа произошла ошибка"},on:{signed:t.load}}):e("application-view",{attrs:{source:t.item}})]:t.isError?e("background-icon-error",[e("p",[t._v("При загрузке документа произошла ошибка")])]):t._e()],2)},mt=[],vt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"application-view"},[e("div",{staticClass:"application-view__padding"},[e("application-info",{attrs:{source:t.source}})],1),e("pdf-viewer",{staticClass:"application-view__pdf",attrs:{id:t.source.id,fileDataLoader:t.fileDataLoader,name:t.source.typeName},on:{done:function(e){t.loading=!1}}}),e("footer",{staticClass:"application-view__footer"},[e("button-1",{on:{click:t.sign}},[t._v("Подписать")])],1),t.loading?e("background-spinner"):t._e()],1)},gt=[],_t=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"application-info"},[t.source.creator?e("user-profile",{attrs:{userProfile:t.source.creator}}):t._e(),e("div",{staticClass:"application-info__text"},[e("p",[e("span",[t._v("Сформировано:")]),t._v(" "+t._s(t.creationDate)+" ")]),e("application-signers",{staticClass:"application-info__signers",attrs:{source:t.source}})],1)],1)},yt=[],wt=s(4503),St=s(7468),Zt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-signers"},[t.approver?e("div",{staticClass:"document-signers__list"},[e("span",[t._v("Кому:")]),e("div",{staticClass:"document-signers__list-item"},[e("signer-profile",{attrs:{source:t.approver},nativeOn:{click:function(e){return t.openProfile(t.approver.profile)}}})],1)]):t._e()])},At=[],Ct=s(3238),xt=s(1687);let It=class extends Ct.Z{get approver(){return{name:this.source.approver.fullName,profile:this.source.approver}}};It=(0,c.gn)([(0,p.wA)({components:{SignerProfile:xt.Z}})],It);var kt=It,bt=kt,Lt=(0,T.Z)(bt,Zt,At,!1,null,null,null),Tt=Lt.exports;let Et=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"source",void 0)}get creationDate(){return(0,St.p)(this.source.createdAt)}get currentUserProfile(){return this.$store.state.userProfile}};(0,c.gn)([(0,p.fI)({required:!0})],Et.prototype,"source",void 0),Et=(0,c.gn)([(0,p.wA)({components:{UserProfile:wt.Z,ApplicationSigners:Tt}})],Et);var Ft=Et,Pt=Ft,Rt=(0,T.Z)(Pt,_t,yt,!1,null,null,null),Dt=Rt.exports,$t=s(946),Nt=s(9097);class Mt{constructor(t){(0,h.Z)(this,"repository",void 0),this.repository=t}load(t){return this.repository.getApplicationFile(t)}}let Ot=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"source",void 0),(0,h.Z)(this,"loading",!0),(0,h.Z)(this,"fileDataLoader",new Mt(this.$hrLinkRepository))}sign(){const t=(0,st.Rg)(this.$store.getters["platform"],{id:this.source.applicationGroupId,isSign:"true"},this.source.typeName);document.location.href=t}};(0,c.gn)([(0,p.fI)({required:!0})],Ot.prototype,"source",void 0),Ot=(0,c.gn)([(0,p.wA)({components:{ApplicationInfo:Dt,PdfViewer:Nt.Z,Button1:S.Z,BackgroundSpinner:$t.Z}})],Ot);var Ut=Ot,Vt=Ut,Bt=(0,T.Z)(Vt,vt,gt,!1,null,null,null),jt=Bt.exports,Ht=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"document-sign"},[t.showMain?[e("div",{staticClass:"document-sign__container"},[e("sign-title",{attrs:{title:t.source.typeName,type:""}}),e("application-info",{attrs:{source:t.source}}),e("pin-code",{attrs:{error:t.isPinCodeError},model:{value:t.pinCodeValue,callback:function(e){t.pinCodeValue=e},expression:"pinCodeValue"}}),e("sign-troubleshooting",{attrs:{codeIsWrong:t.currentState.matches(t.State.wrongCode),canRestartSign:t.canRestartSign,time:t.time},on:{restart:t.restart}})],1),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.confirm}},[t._v("Подтвердить")])],1)]:t._e(),t.onSignStart||t.onSendingTheCode?e("sign-loading",{attrs:{type:"заявление",showText:t.onSendingTheCode}}):t._e(),t.currentState.matches(t.State.startSignError)?[e("background-icon-error",[e("p",[t._v(t._s(t.errorMessage))])]),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.startSign}},[t._v("Повторить попытку")])],1)]:t._e(),t.currentState.matches(t.State.signError)?[e("background-icon-error",[e("p",[t._v("Ошибка! "),e("br"),t._v(" Не удалось подписать заявление")])]),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.confirm}},[t._v("Повторить попытку")])],1)]:t._e(),t.currentState.matches(t.State.signIsSucceed)?[e("background-icon-success",[e("p",[t._v("Вы подписали заявление!")])]),e("footer",{staticClass:"document-sign__footer"},[e("button-1",{on:{click:t.goToList}},[t._v("К списку заявлений")])],1)]:t._e()],2)},Gt=[],Wt=s(388),qt=s(2027),Kt=s(2378),zt=s(3897),Jt=s(3987),Qt=s(7834),Xt=s(2504);let Yt=class extends Wt.Z{constructor(...t){super(...t),(0,h.Z)(this,"source",void 0)}mounted(){this.startSign()}goToList(){const t=[{type:it.Z["new"]},{type:it.Z.filter}],e=(0,st.Rg)(this.$store.getters["platform"],{},"Мои заявления",t);document.location.href=e}};(0,c.gn)([(0,p.fI)({required:!0})],Yt.prototype,"source",void 0),Yt=(0,c.gn)([(0,p.wA)({components:{ApplicationInfo:Dt,PinCode:qt.Z,Button1:S.Z,BackgroundIconError:g.Z,BackgroundIconSuccess:Kt.Z,BackgroundIconKey:zt.Z,SignTroubleshooting:Jt.Z,SignTitle:Qt.Z,SignLoading:Xt.Z}})],Yt);var te=Yt,ee=te,se=(0,T.Z)(ee,Ht,Gt,!1,null,null,null),ie=se.exports;let re=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"id",void 0),(0,h.Z)(this,"item",null),(0,h.Z)(this,"isError",!1)}created(){this.load()}async load(){try{const t=await this.$hrLinkRepository.getApplication(this.id);this.item=t,this.isError=!1}catch(t){this.isError=!0}}get isSign(){return"true"===(this.$store.getters["urlParam"]("isSign")??"")}};(0,c.gn)([(0,p.fI)({required:!0})],re.prototype,"id",void 0),re=(0,c.gn)([(0,p.wA)({components:{ApplicationView:jt,BackgroundIconError:g.Z,ApplicationSign:ie}})],re);var oe,ne=re,ae=ne,le=(0,T.Z)(ae,ft,mt,!1,null,null,null),ce=le.exports,pe=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"applications-create"},[t.isError?t._e():[e("form-group",{staticClass:"applications-create__type",attrs:{name:"Тип заявления"}},[e("select-control",{attrs:{items:t.applicationTypesList,placeholder:"Выберите тип заявления","is-loading":t.isLoading,"is-ajax":!1,"select-model":!1},model:{value:t.selectedTypeId,callback:function(e){t.selectedTypeId=e},expression:"selectedTypeId"}})],1),t.selectedTypeId?e("application-form",{staticClass:"applications-create__form",attrs:{selectedTypeId:t.selectedTypeId,mainFields:t.mainFields,systemFields:t.systemFields},on:{loading:function(e){t.isLoading=e},error:t.makeError}}):t._e()],t.isLoading?e("background-spinner"):t._e(),t.isError?[e("background-icon-error",[e("p",[t._v(t._s(t.errorMessage||"При загрузке типов заявлений произошла ошибка"))])]),e("footer",{staticClass:"applications-create__footer"},[e("button-1",{on:{click:t.retry}},[t._v("Попробовать снова")])],1)]:t._e()],2)},ue=[],de=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"application-form"},[t.isError?t._e():[e("div",{staticClass:"application-form__extra-controls"},[e("form-group",{attrs:{name:"Получатель заявления"}},[e("select-control",{attrs:{items:t.approversList,placeholder:"Выберите получателя","is-loading":!1,"is-ajax":!1,"select-model":!1},scopedSlots:t._u([{key:"default",fn:function({item:t}){return[e("div",{staticClass:"application-form__approver-profile"},[e("user-profile-component",{attrs:{userProfile:t.profile}})],1)]}}],null,!1,3640830242),model:{value:t.selectedApproverUserId,callback:function(e){t.selectedApproverUserId=e},expression:"selectedApproverUserId"}}),t.errors.selectedApproverUserId?e("span",{staticClass:"form-error"},[t._v("Обязательное поле")]):t._e()],1),e("form-group",{attrs:{name:"Дата заявления"}},[e("date-input",{attrs:{needClear:!1},model:{value:t.applicationDate,callback:function(e){t.applicationDate=e},expression:"applicationDate"}})],1),t.errors.applicationDate?e("span",{staticClass:"form-error"},[t._v("Обязательное поле")]):t._e()],1),e("form",{staticClass:"application-form__form",on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)},input:t.resetFieldError}},[e("div",{staticClass:"application-form__container"},[e("form-control-list",{attrs:{fields:t.systemFields,errors:t.errors}}),e("form-control-list",{attrs:{fields:t.mainFields,errors:t.errors}})],1),e("footer",{staticClass:"application-form__footer"},[e("button-1",{attrs:{type:"submit"}},[t._v("Отправить")])],1)])]],2)},he=[];(function(t){t["string"]="STRING",t["number"]="NUMBER",t["date"]="DATE"})(oe||(oe={}));var fe=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"selector",class:{"is-active":t.active}},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.active,expression:"!active"}],staticClass:"selector__label",class:{"is-placeholder":!t.selected},on:{click:t.onFocus}},[t._v(" "+t._s(t.label)+" ")]),t.active?e("input",{ref:"input",attrs:{type:"text",placeholder:t.currentPlaceholder},domProps:{value:t.search},on:{focus:t.onFocus,input:t.onSearchInput}}):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"selector__arrow",on:{click:t.onFocus}},[e("arrow")],1),t.isLoading?e("div",{staticClass:"selector__spinner"},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none"}},[e("path",{attrs:{fill:"#F39420","fill-opacity":".12","fill-rule":"evenodd",d:"M12 21.818c5.422 0 9.818-4.396 9.818-9.818S17.422 2.182 12 2.182 2.182 6.578 2.182 12 6.578 21.818 12 21.818ZM12 24c6.627 0 12-5.373 12-12S18.627 0 12 0 0 5.373 0 12s5.373 12 12 12Z","clip-rule":"evenodd"}}),e("path",{attrs:{fill:"#F39420",d:"M12 21.818c5.422 0 9.818-4.396 9.818-9.818S17.422 2.182 12 2.182V0c6.627 0 12 5.373 12 12s-5.373 12-12 12S0 18.627 0 12h2.182c0 5.422 4.396 9.818 9.818 9.818Z"}})])]):t._e(),e("div",{staticClass:"selector__items"},[t._l(t.filteredList,(function(s){return e("div",{key:s.id,staticClass:"selector__item",class:{"is-selected":t.isSelected(s)},on:{click:function(e){return t.select(s)}}},[t._t("default",(function(){return[t._v(t._s(s.title))]}),{item:s})],2)})),t.isLoading?t._e():[t.showNotFound?e("div",{staticClass:"selector__item is-non-selectable"},[t._v("Не найдено")]):t._e(),t.showAjaxHint?e("div",{staticClass:"selector__item is-non-selectable"},[t._v("Введите несколько символов для начала поиска")]):t._e()]],2)])},me=[],ve=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("svg",{attrs:{width:"12",height:"7",viewBox:"0 0 12 7",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M1 1L6 6L11 1",stroke:"#8E8E93"}})])},ge=[];let _e=class extends p.w3{};_e=(0,c.gn)([p.wA],_e);var ye=_e,we=ye,Se=(0,T.Z)(we,ve,ge,!1,null,null,null),Ze=Se.exports;let Ae=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"value",void 0),(0,h.Z)(this,"placeholder",void 0),(0,h.Z)(this,"items",void 0),(0,h.Z)(this,"selectModel",void 0),(0,h.Z)(this,"disabled",void 0),(0,h.Z)(this,"isLoading",void 0),(0,h.Z)(this,"isAjax",void 0),(0,h.Z)(this,"selectField",void 0),(0,h.Z)(this,"active",!1),(0,h.Z)(this,"search",""),(0,h.Z)(this,"selected",null),(0,h.Z)(this,"blockSearchEmit",!1),(0,h.Z)(this,"previousEmitValue",""),(0,h.Z)(this,"isTyping",!1),(0,h.Z)(this,"typingTimeout",0)}get showNotFound(){return!(this.isLoading||this.isAjax&&this.isTyping)&&(this.active&&0==this.filteredList.length&&(this.search||!this.isAjax))}get showAjaxHint(){return this.active&&0==this.filteredList.length&&!this.search&&this.isAjax}mounted(){this.value&&this.setSelected()}onSearchChange(t,e){this.blockSearchEmit?this.blockSearchEmit=!1:t!=e&&this.previousEmitValue.substring(0,3)!=this.search.substring(0,3)&&(this.$emit("searchChanged",this.search),this.previousEmitValue=this.search)}get currentPlaceholder(){return this.placeholder}get label(){return this.selected&&this.selected.title?this.selected.title:this.placeholder}onValueChange(){this.setSelected()}onItemsChange(){this.setSelected()}onSearchInput(t){clearTimeout(this.typingTimeout),this.search=t.target.value,this.isTyping=!0,this.typingTimeout=setTimeout((()=>{this.isTyping=!1}),500)}get normalizedList(){return this.items.map((t=>"string"==typeof t?{id:t,title:t}:t))}get filteredList(){if(this.isAjax&&0==this.search.length)return[];const t=this.search.toLowerCase().trim().split(" ");return this.normalizedList.filter((e=>{let s=e.title.toLowerCase(),i=!0;return t.forEach((t=>{i=i&&s.indexOf(t)>=0})),i}))}setSelected(){if(this.selectModel)this.selected=this.value;else{const t=this.normalizedList.find((t=>t[this.selectField]==this.value));t&&(this.selected=t)}}isSelected(t){return this.selectModel?this.value&&this.value.id&&t.id==this.value.id:t.id==this.value}onFocus(){this.disabled||(this.active=!0,this.$nextTick((()=>{this.isAjax&&this.$refs.input&&this.$refs.input.focus()})),setTimeout((()=>{document.addEventListener("click",this.documentClick)}),500))}documentClick(t){this.isSelectorElement(t.target)||(this.blur(),document.removeEventListener("click",this.documentClick))}select(t){this.selectModel?this.$emit("input",t):this.$emit("input",t[this.selectField]),this.$emit("changed",t),this.selected=t,this.blur()}blur(){this.blockSearchEmit=!0,this.search="",this.$refs.input&&this.$refs.input.blur(),this.active=!1}isSelectorElement(t){let e=!1,s=t;while(s){if(e=s==this.$el,e)break;s=s.parentNode}return e}};(0,c.gn)([(0,p.fI)({required:!0})],Ae.prototype,"value",void 0),(0,c.gn)([(0,p.fI)({default:""})],Ae.prototype,"placeholder",void 0),(0,c.gn)([(0,p.fI)({default:()=>[]})],Ae.prototype,"items",void 0),(0,c.gn)([(0,p.fI)({default:!1})],Ae.prototype,"selectModel",void 0),(0,c.gn)([(0,p.fI)({default:!1})],Ae.prototype,"disabled",void 0),(0,c.gn)([(0,p.fI)({default:!1})],Ae.prototype,"isLoading",void 0),(0,c.gn)([(0,p.fI)({default:!1})],Ae.prototype,"isAjax",void 0),(0,c.gn)([(0,p.fI)({default:"id"})],Ae.prototype,"selectField",void 0),(0,c.gn)([(0,p.RL)("search")],Ae.prototype,"onSearchChange",null),(0,c.gn)([(0,p.RL)("value")],Ae.prototype,"onValueChange",null),(0,c.gn)([(0,p.RL)("items")],Ae.prototype,"onItemsChange",null),Ae=(0,c.gn)([(0,p.wA)({components:{Arrow:Ze}})],Ae);var Ce=Ae,xe=Ce,Ie=(0,T.Z)(xe,fe,me,!1,null,null,null),ke=Ie.exports,be=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"form-group"},[e("label",{attrs:{for:t.nameFor}},[t._v(t._s(t.name))]),t._t("default")],2)},Le=[];let Te=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"name",void 0),(0,h.Z)(this,"nameFor",void 0)}};(0,c.gn)([(0,p.fI)()],Te.prototype,"name",void 0),(0,c.gn)([(0,p.fI)()],Te.prototype,"nameFor",void 0),Te=(0,c.gn)([(0,p.wA)({components:{}})],Te);var Ee=Te,Fe=Ee,Pe=(0,T.Z)(Fe,be,Le,!1,null,null,null),Re=Pe.exports,De=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"form-control-list"},t._l(t.fields,(function(s){return e("div",{staticClass:"form-control-list__item"},[e("form-group",{attrs:{name:s.label,nameFor:s.id}},[s.type===t.FieldType.string?e("text-input",{attrs:{name:s.id}}):t._e(),s.type===t.FieldType.number?e("number-input",{attrs:{name:s.id}}):t._e(),s.type===t.FieldType.date?e("date-input",{attrs:{name:s.id,value:""}}):t._e(),t.errors[s.id]?e("span",{staticClass:"form-error"},[t._v("Обязательное поле")]):t._e()],1)],1)})),0)},$e=[],Ne=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("input",t._b({staticClass:"text-input",attrs:{type:"text"}},"input",t.$attrs,!1))},Me=[];let Oe=class extends p.w3{};Oe=(0,c.gn)([(0,p.wA)({components:{}})],Oe);var Ue=Oe,Ve=Ue,Be=(0,T.Z)(Ve,Ne,Me,!1,null,null,null),je=Be.exports,He=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("input",t._b({staticClass:"number-input",attrs:{inputmode:"numeric",type:"number"}},"input",t.$attrs,!1))},Ge=[];let We=class extends p.w3{};We=(0,c.gn)([(0,p.wA)({components:{}})],We);var qe=We,Ke=qe,ze=(0,T.Z)(Ke,He,Ge,!1,null,null,null),Je=ze.exports;let Qe=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"fields",void 0),(0,h.Z)(this,"errors",void 0),(0,h.Z)(this,"FieldType",oe)}};(0,c.gn)([(0,p.fI)()],Qe.prototype,"fields",void 0),(0,c.gn)([(0,p.fI)()],Qe.prototype,"errors",void 0),Qe=(0,c.gn)([(0,p.wA)({components:{DateInput:w.Z,TextInput:je,NumberInput:Je,FormGroup:Re}})],Qe);var Xe=Qe,Ye=Xe,ts=(0,T.Z)(Ye,De,$e,!1,null,null,null),es=ts.exports;const ss=(t,e)=>{try{return JSON.parse(t)}catch(s){return void 0!==e?e:t}};class is{constructor(){(0,h.Z)(this,"storage",void 0),this.storage=window.localStorage}set(t,e){this.storage?.setItem(t,JSON.stringify(e))}get(t){return ss(this.storage?.getItem(t))}}var rs=s(9490);class os{constructor(t,e,s){(0,h.Z)(this,"hrLinkRepository",void 0),(0,h.Z)(this,"localStorageClient",void 0),(0,h.Z)(this,"userId",void 0),this.hrLinkRepository=t,this.localStorageClient=e,this.userId=s}async getApproversList(t,e){const s={include:["firstName","firstNameRaw","lastName","lastNameRaw","middleName","middleNameRaw","userId","position","positionRaw","photoFileId"],where:{directionId:t},take:-1},i=await this.hrLinkRepository.getColleagues(s);return i.filter((t=>t.userId!==e))}storeSelectedApprover(t){this.localStorageClient.set(this.getApproversLsKey(this.userId),t)}restoreSelectedApprover(t){const e=this.localStorageClient.get(this.getApproversLsKey(this.userId))||null,s=t.find((t=>t.id===e));if(s)return e}storeSystemValues(t){this.localStorageClient.set(this.getSystemFieldsLsKey(this.userId),t)}restoreSystemValues(){return this.localStorageClient.get(this.getSystemFieldsLsKey(this.userId))||null}getApproversLsKey(t){return"selected-approver-id_"+t}getSystemFieldsLsKey(t){return"saved-system-fields_"+t}}let ns=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"mainFields",void 0),(0,h.Z)(this,"systemFields",void 0),(0,h.Z)(this,"selectedTypeId",void 0),(0,h.Z)(this,"localStorageClient",new is),(0,h.Z)(this,"selectedApproverUserId",null),(0,h.Z)(this,"applicationDate",""),(0,h.Z)(this,"approversList",[]),(0,h.Z)(this,"FieldType",oe),(0,h.Z)(this,"errors",{selectedApproverUserId:!1,applicationDate:!1}),(0,h.Z)(this,"service",null),(0,h.Z)(this,"isError",!1)}async created(){const t=this.currentUserProfile.directionId;if(t&&this.currentUserProfile.userId){this.service=new os(this.$hrLinkRepository,this.localStorageClient,this.currentUserProfile.userId);try{this.$emit("loading",!0);const e=await this.service.getApproversList(t,this.currentUserProfile.userId);this.approversList=e.map((t=>({profile:t,id:t.userId,title:t.fullName}))),this.restoreSelectedApprover()}catch(e){this.$emit("error","При загрузке дополнительных данных произошла ошибка"),this.$store.dispatch("reportError",e)}finally{this.$emit("loading",!1)}}}mounted(){this.applicationDate=rs.ou.local().toFormat("yyyy-LL-dd"),this.restoreSystemValues()}async submit(t){const e=t.target,s=new FormData(e),i=Array.from(s.entries()),r=i.filter((t=>this.systemFieldsIds.includes(t[0]))),o=i.filter((t=>this.mainFieldsIds.includes(t[0])));this.storeSystemValues(r);const n=this.validate(i);if(!n)return;if(!this.selectedApproverUserId)throw Error("selectedApproverUserId must be set");const a=t=>({id:t[0],value:t[1]}),l=r.map(a),c=o.map(a),p={approverUserId:this.selectedApproverUserId,typeId:this.selectedTypeId,templateFields:c,templateSystemFields:l,date:this.applicationDate};try{this.$emit("loading",!0);const t=await this.$hrLinkRepository.createApplication(p);t?this.goToApplication(t):this.$emit("error","При создании заявления произошла ошибка")}catch(t){this.$emit("error","При создании заявления произошла ошибка"),this.$store.dispatch("reportError",t)}finally{this.$emit("loading",!1)}}goToApplication(t){const e=(0,st.Rg)(this.$store.getters["platform"],{id:t.applicationGroupId},t.typeName);document.location.href=e}validate(t){let e=!1;this.selectedApproverUserId&&this.applicationDate||(this.errors.selectedApproverUserId=!this.selectedApproverUserId,this.errors.applicationDate=!this.applicationDate,e=!0);for(const s of t)s[1]||(e||(e=!0),p.w3.set(this.errors,s[0],!0));return!e}resetFieldError(t){const e=t.target;this.errors[e?.name||""]=!1}storeSelectedApprover(t){this.service?.storeSelectedApprover(t)}restoreSelectedApprover(){this.selectedApproverUserId=this.service?.restoreSelectedApprover(this.approversList)||null}storeSystemValues(t){this.service?.storeSystemValues(t)}restoreSystemValues(){const t=this.service?.restoreSystemValues()||null;if(t){const e=this.$el.querySelectorAll("input"),s=Object.fromEntries(t);for(const t of e)s[t.name]&&(t.value=s[t.name])}}watchSelectedApproverUserIdHandler(t){this.storeSelectedApprover(t),this.errors.selectedApproverUserId=!1}watchApplicationDateHandler(t){}get systemFieldsIds(){return this.systemFields.map((t=>t.id))}get mainFieldsIds(){return this.mainFields.map((t=>t.id))}get currentUserProfile(){return this.$store.state.userProfile}get userId(){return this.currentUserProfile.userId}};(0,c.gn)([(0,p.fI)({default:()=>[]})],ns.prototype,"mainFields",void 0),(0,c.gn)([(0,p.fI)({default:()=>[]})],ns.prototype,"systemFields",void 0),(0,c.gn)([(0,p.fI)()],ns.prototype,"selectedTypeId",void 0),(0,c.gn)([(0,p.RL)("selectedApproverUserId")],ns.prototype,"watchSelectedApproverUserIdHandler",null),(0,c.gn)([(0,p.RL)("applicationDate")],ns.prototype,"watchApplicationDateHandler",null),ns=(0,c.gn)([(0,p.wA)({components:{Button1:S.Z,FormControlList:es,DateInput:w.Z,FormGroup:Re,SelectControl:ke,UserProfileComponent:wt.Z}})],ns);var as=ns,ls=as,cs=(0,T.Z)(ls,de,he,!1,null,null,null),ps=cs.exports;let us=class extends p.w3{constructor(...t){super(...t),(0,h.Z)(this,"selectedTypeId",""),(0,h.Z)(this,"applicationTypesData",null),(0,h.Z)(this,"isLoading",!1),(0,h.Z)(this,"isError",!1),(0,h.Z)(this,"errorMessage","")}created(){this.loadTypes()}async loadTypes(){try{this.isLoading=!0,this.applicationTypesData=await this.$hrLinkRepository.getApplicationsTypes()}catch(t){this.isError=!0,this.$store.dispatch("reportError",t)}finally{this.isLoading=!1}}makeError(t){this.isError=!0,this.errorMessage=t}resetError(){this.isError=!1,this.errorMessage=""}retry(){this.resetError(),this.applicationTypesData||this.loadTypes()}get currentUserProfile(){return this.$store.state.userProfile}get applicationTypesList(){return this.applicationTypesData?.types?.filter((t=>t.templatable)).map((t=>({id:t.id,title:t.name})))||[]}get selectedType(){return this.applicationTypesData?.types.find((t=>t.id===this.selectedTypeId))}get mainFields(){return this.selectedType?.templateFields||[]}get systemFields(){return this.applicationTypesData?.templateSystemFields||[]}};us=(0,c.gn)([(0,p.wA)({components:{DateInput:w.Z,ApplicationForm:ps,SelectControl:ke,FormGroup:Re,BackgroundIconError:g.Z,BackgroundSpinner:$t.Z,Button1:S.Z}})],us);var ds=us,hs=ds,fs=(0,T.Z)(hs,pe,ue,!1,null,null,null),ms=fs.exports;let vs=class extends p.w3{created(){const t=Object.fromEntries(new URL(window.location.toString()).searchParams.entries());this.$store.commit("setUrlParams",t)}get id(){return this.$store.getters["urlParam"]("id")??""}get isApplicationCreate(){return"true"===(this.$store.getters["urlParam"]("isApplicationCreate")??"")}};vs=(0,c.gn)([(0,p.wA)({components:{ApplicationsList:ht,ApplicationCreate:ms,ApplicationDetail:ce}})],vs);var gs=vs,_s=gs,ys=(0,T.Z)(_s,a,l,!1,null,null,null),ws=ys.exports;i["default"].config.productionTip=!1,i["default"].use(r.Z),i["default"].use(o.ZP);const Ss=(0,n.p)(ws,"applications");Ss.$mount("#app")}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=t,function(){s.amdO={}}(),function(){var t=[];s.O=function(e,i,r,o){if(!i){var n=1/0;for(p=0;p<t.length;p++){i=t[p][0],r=t[p][1],o=t[p][2];for(var a=!0,l=0;l<i.length;l++)(!1&o||n>=o)&&Object.keys(s.O).every((function(t){return s.O[t](i[l])}))?i.splice(l--,1):(a=!1,o<n&&(n=o));if(a){t.splice(p--,1);var c=r();void 0!==c&&(e=c)}}return e}o=o||0;for(var p=t.length;p>0&&t[p-1][2]>o;p--)t[p]=t[p-1];t[p]=[i,r,o]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={383:0};s.O.j=function(e){return 0===t[e]};var e=function(e,i){var r,o,n=i[0],a=i[1],l=i[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(l)var p=l(s)}for(e&&e(i);c<n.length;c++)o=n[c],s.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return s.O(p)},i=self["webpackChunkugmk_documents"]=self["webpackChunkugmk_documents"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998,64],(function(){return s(2108)}));i=s.O(i)})();